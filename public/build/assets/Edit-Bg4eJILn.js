import{d as A,j as k,q as E,c as p,a as o,u as r,h as R,w as n,b as s,t as b,l as I,e as i,m as g,o as v,F as V,r as w,v as y,s as j,f as M,x as S}from"./app-a-DHXOwM.js";import{_ as u}from"./InputError.vue_vue_type_script_setup_true_lang-B9GZNRQO.js";import{_ as U}from"./LoadingButton.vue_vue_type_script_setup_true_lang-CRA_LL6X.js";import{_ as Y}from"./FlashMessages.vue_vue_type_script_setup_true_lang-C874Aq3G.js";import{_ as c}from"./Input.vue_vue_type_script_setup_true_lang-I2dLO8Av.js";import{_ as C}from"./Label.vue_vue_type_script_setup_true_lang-9IZDJ9H_.js";import{_ as q}from"./AppLayout.vue_vue_type_script_setup_true_lang-CGJuVEXM.js";import"./Spinner.vue_vue_type_script_setup_true_lang-CkWcZB8r.js";import"./createLucideIcon-DRPyjv3y.js";import"./index-Ct-cmca8.js";import"./index-BAre4RwE.js";import"./useForwardExpose-BrydD-LM.js";import"./RovingFocusGroup-XsV0CvC-.js";import"./UserMenuContent.vue_vue_type_script_setup_true_lang-nkoA9ZOP.js";import"./useForwardPropsEmits-CZfNtvzl.js";import"./index-ueziRkVZ.js";import"./VisuallyHidden-CbnLjvn_.js";const L={class:"mx-auto w-full max-w-4xl space-y-4 p-4"},P={class:"flex items-center justify-between"},T={class:"mt-1 text-sm text-muted-foreground"},z={class:"rounded-xl border border-border bg-card p-4 text-sm"},G=["href"],H={class:"rounded-xl border border-border bg-card p-4"},J={class:"grid gap-3"},K={class:"grid gap-2 md:grid-cols-2"},O={class:"grid gap-2"},Q=["value"],W={class:"grid gap-2"},X=["value"],Z={class:"grid gap-2"},h=["value"],ee={class:"flex items-center gap-2 text-xs"},se={key:0,class:"rounded-md border border-amber-500/30 bg-amber-500/10 px-3 py-2 text-xs text-amber-600 dark:text-amber-300"},re={class:"grid gap-4 md:grid-cols-2"},te={class:"rounded-xl border border-border bg-card p-4"},le=["disabled"],oe={class:"rounded-xl border border-border bg-card p-4"},de=["disabled"],Se=A({__name:"Edit",props:{user:{},currentUserId:{},universities:{},courses:{},courseYears:{}},setup(a){const d=a,t=k({name:d.user.name,email:d.user.email,username:d.user.username,website:d.user.website??"",is_verified:!!d.user.is_verified,email_verified_at:d.user.email_verified_at?String(d.user.email_verified_at).slice(0,16):"",university_id:d.user.university_id??null,course_id:d.user.course_id??null,course_year_id:d.user.course_year_id??null}),_=k({status:d.user.status}),x=k({role:d.user.role}),f=S(()=>d.currentUserId===null||d.currentUserId!==d.user.id),$=S(()=>t.university_id===null?[]:d.courses.filter(m=>m.university_id===t.university_id)),N=S(()=>t.course_id===null?[]:d.courseYears.filter(m=>m.course_id===t.course_id));E(()=>t.university_id,()=>{t.course_id!==null&&!$.value.some(m=>m.id===t.course_id)&&(t.course_id=null,t.course_year_id=null)}),E(()=>t.course_id,()=>{t.course_year_id!==null&&!N.value.some(m=>m.id===t.course_year_id)&&(t.course_year_id=null)});const F=()=>{t.put(`/admin/users/${d.user.id}`,{preserveScroll:!0})},B=()=>{f.value&&_.put(`/admin/users/${d.user.id}/status`,{preserveScroll:!0})},D=()=>{f.value&&x.put(`/admin/users/${d.user.id}/role`,{preserveScroll:!0})};return(m,e)=>(v(),p(V,null,[o(r(R),{title:`Edit ${a.user.name}`},null,8,["title"]),o(q,null,{default:n(()=>[s("div",L,[s("div",P,[s("div",null,[e[11]||(e[11]=s("h1",{class:"text-2xl font-semibold"},"Edit User",-1)),s("p",T," @"+b(a.user.username),1)]),o(r(I),{href:"/admin/users"},{default:n(()=>[o(r(Y),{variant:"outline"},{default:n(()=>[...e[12]||(e[12]=[i("Back to Users",-1)])]),_:1})]),_:1})]),s("div",z,[s("p",null,[e[13]||(e[13]=s("span",{class:"text-muted-foreground"},"University:",-1)),i(" "+b(a.user.university?.name??"Not set"),1)]),s("p",null,[e[14]||(e[14]=s("span",{class:"text-muted-foreground"},"Course:",-1)),i(" "+b(a.user.course?.name??"Not set"),1)]),s("p",null,[e[15]||(e[15]=s("span",{class:"text-muted-foreground"},"Cohort:",-1)),i(" "+b(a.user.course_year?.year?`Class of ${a.user.course_year.year}`:"Not set"),1)]),s("p",null,[e[16]||(e[16]=s("span",{class:"text-muted-foreground"},"Public profile:",-1)),s("a",{href:`/@${a.user.username}`,target:"_blank",rel:"noopener noreferrer",class:"underline underline-offset-4"}," View profile ",8,G)])]),s("div",H,[e[26]||(e[26]=s("h2",{class:"mb-3 text-base font-semibold"},"User Details",-1)),s("div",J,[s("div",null,[o(r(c),{modelValue:r(t).name,"onUpdate:modelValue":e[0]||(e[0]=l=>r(t).name=l),placeholder:"Full name"},null,8,["modelValue"]),o(u,{message:r(t).errors.name},null,8,["message"])]),s("div",null,[o(r(c),{modelValue:r(t).email,"onUpdate:modelValue":e[1]||(e[1]=l=>r(t).email=l),type:"email",placeholder:"Email"},null,8,["modelValue"]),o(u,{message:r(t).errors.email},null,8,["message"])]),s("div",null,[o(r(c),{modelValue:r(t).username,"onUpdate:modelValue":e[2]||(e[2]=l=>r(t).username=l),placeholder:"username"},null,8,["modelValue"]),o(u,{message:r(t).errors.username},null,8,["message"])]),s("div",null,[o(r(c),{modelValue:r(t).website,"onUpdate:modelValue":e[3]||(e[3]=l=>r(t).website=l),placeholder:"example.com"},null,8,["modelValue"]),o(u,{message:r(t).errors.website},null,8,["message"])]),s("div",K,[s("div",O,[o(r(C),{for:"university_id"},{default:n(()=>[...e[17]||(e[17]=[i("University",-1)])]),_:1}),g(s("select",{id:"university_id","onUpdate:modelValue":e[4]||(e[4]=l=>r(t).university_id=l),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},[e[18]||(e[18]=s("option",{value:null},"Not set",-1)),(v(!0),p(V,null,w(a.universities,l=>(v(),p("option",{key:l.id,value:l.id},b(l.name),9,Q))),128))],512),[[y,r(t).university_id]]),o(u,{message:r(t).errors.university_id},null,8,["message"])]),s("div",W,[o(r(C),{for:"course_id"},{default:n(()=>[...e[19]||(e[19]=[i("Course",-1)])]),_:1}),g(s("select",{id:"course_id","onUpdate:modelValue":e[5]||(e[5]=l=>r(t).course_id=l),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},[e[20]||(e[20]=s("option",{value:null},"Not set",-1)),(v(!0),p(V,null,w($.value,l=>(v(),p("option",{key:l.id,value:l.id},b(l.short_name),9,X))),128))],512),[[y,r(t).course_id]]),o(u,{message:r(t).errors.course_id},null,8,["message"])])]),s("div",Z,[o(r(C),{for:"course_year_id"},{default:n(()=>[...e[21]||(e[21]=[i("Cohort",-1)])]),_:1}),g(s("select",{id:"course_year_id","onUpdate:modelValue":e[6]||(e[6]=l=>r(t).course_year_id=l),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},[e[22]||(e[22]=s("option",{value:null},"Not set",-1)),(v(!0),p(V,null,w(N.value,l=>(v(),p("option",{key:l.id,value:l.id}," Class of "+b(l.year),9,h))),128))],512),[[y,r(t).course_year_id]]),o(u,{message:r(t).errors.course_year_id},null,8,["message"])]),s("label",ee,[g(s("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>r(t).is_verified=l),type:"checkbox"},null,512),[[j,r(t).is_verified]]),e[23]||(e[23]=i(" Verified profile ",-1))]),s("div",null,[e[24]||(e[24]=s("label",{class:"mb-1 block text-xs font-medium text-muted-foreground"}," Email verified at ",-1)),o(r(c),{modelValue:r(t).email_verified_at,"onUpdate:modelValue":e[8]||(e[8]=l=>r(t).email_verified_at=l),type:"datetime-local"},null,8,["modelValue"]),o(u,{message:r(t).errors.email_verified_at},null,8,["message"])]),o(U,{type:"button",loading:r(t).processing,"loading-text":"Saving...",onClick:F},{default:n(()=>[...e[25]||(e[25]=[i(" Save Details ",-1)])]),_:1},8,["loading"])])]),f.value?M("",!0):(v(),p("p",se," You cannot modify your own role or account status. ")),s("div",re,[s("div",te,[e[29]||(e[29]=s("h2",{class:"mb-3 text-base font-semibold"},"Account Status",-1)),g(s("select",{"onUpdate:modelValue":e[9]||(e[9]=l=>r(_).status=l),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm",disabled:!f.value},[...e[27]||(e[27]=[s("option",{value:"active"},"Active",-1),s("option",{value:"suspended"},"Suspended",-1),s("option",{value:"banned"},"Banned",-1)])],8,le),[[y,r(_).status]]),o(u,{message:r(_).errors.status},null,8,["message"]),o(U,{type:"button",class:"mt-3",loading:r(_).processing,"loading-text":"Saving...",disabled:!f.value,onClick:B},{default:n(()=>[...e[28]||(e[28]=[i(" Save Status ",-1)])]),_:1},8,["loading","disabled"])]),s("div",oe,[e[32]||(e[32]=s("h2",{class:"mb-3 text-base font-semibold"},"Role",-1)),g(s("select",{"onUpdate:modelValue":e[10]||(e[10]=l=>r(x).role=l),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm",disabled:!f.value},[...e[30]||(e[30]=[s("option",{value:"student"},"Student",-1),s("option",{value:"admin"},"Admin",-1),s("option",{value:"superadmin"},"Superadmin",-1)])],8,de),[[y,r(x).role]]),o(u,{message:r(x).errors.role},null,8,["message"]),o(U,{type:"button",class:"mt-3",loading:r(x).processing,"loading-text":"Saving...",disabled:!f.value,onClick:D},{default:n(()=>[...e[31]||(e[31]=[i(" Save Role ",-1)])]),_:1},8,["loading","disabled"])])])])]),_:1})],64))}});export{Se as default};
