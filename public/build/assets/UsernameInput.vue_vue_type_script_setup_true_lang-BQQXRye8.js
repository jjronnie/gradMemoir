import{_}from"./InputError.vue_vue_type_script_setup_true_lang-CDABBYxE.js";import{_ as C}from"./index-CA47rZK0.js";import{_ as k}from"./Input.vue_vue_type_script_setup_true_lang-F-YZz48X.js";import{d as x,g,q as V,c as o,b as y,a as m,u as b,w as $,e as j,n as A,A as w,o as r,Q as N,f as h}from"./app-B60bE2S9.js";const T={class:"space-y-3"},U={class:"h-28 w-28 overflow-hidden rounded-full border border-border bg-muted"},B=["src"],R={key:1,class:"flex h-full w-full items-center justify-center text-xs text-muted-foreground"},D=x({__name:"AvatarUpload",props:{modelValue:{},currentAvatar:{default:null},name:{default:"avatar"}},emits:["update:modelValue"],setup(n,{emit:p}){const e=n,u=p,v=w(),a=g(e.currentAvatar);V(()=>e.currentAvatar,d=>{e.modelValue===null&&(a.value=d??null)});const s=A(()=>v.props.errors?.[e.name]??null),i=d=>{const l=d.target.files?.[0]??null;if(u("update:modelValue",l),l===null){a.value=e.currentAvatar??null;return}const c=new FileReader;c.onload=()=>{a.value=c.result},c.readAsDataURL(l)},f=()=>{u("update:modelValue",null),a.value=e.currentAvatar??null};return(d,t)=>(r(),o("div",T,[y("div",U,[a.value?(r(),o("img",{key:0,src:a.value,alt:"Avatar preview",class:"h-full w-full object-cover"},null,8,B)):(r(),o("div",R," No image "))]),m(b(k),{name:n.name,type:"file",accept:".jpg,.jpeg,.png,.webp,.gif,.avif",onChange:i},null,8,["name"]),m(b(C),{type:"button",variant:"outline",size:"sm",onClick:f},{default:$(()=>[...t[0]||(t[0]=[j(" Clear ",-1)])]),_:1}),m(_,{message:s.value},null,8,["message"])]))}}),q={class:"grid gap-2"},S={class:"relative"},E={key:0,class:"text-xs text-muted-foreground"},F={key:0},O={key:1,class:"text-green-600"},X={key:2,class:"text-destructive"},H=x({__name:"UsernameInput",props:{modelValue:{},name:{default:"username"},disabled:{type:Boolean,default:!1},checkAvailability:{type:Boolean,default:!0}},emits:["update:modelValue","availability"],setup(n,{emit:p}){const e=n,u=p,v=w(),a=g(!1),s=g(null);let i=null;const f=A(()=>v.props.errors?.[e.name]??null),d=async t=>{if(e.checkAvailability){if(t.length<3){s.value=null,u("availability",null);return}a.value=!0;try{const c=await(await fetch("/api/check-username",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")??""},body:JSON.stringify({username:t})})).json();s.value=c.data?.available??!1,u("availability",s.value)}catch{s.value=null,u("availability",null)}finally{a.value=!1}}};return V(()=>e.modelValue,t=>{i!==null&&clearTimeout(i),i=setTimeout(()=>{d(t)},400)}),N(()=>{i!==null&&clearTimeout(i)}),(t,l)=>(r(),o("div",q,[y("div",S,[l[1]||(l[1]=y("span",{class:"absolute top-1/2 left-3 -translate-y-1/2 text-muted-foreground"},"@",-1)),m(b(k),{name:n.name,disabled:n.disabled,"model-value":n.modelValue,class:"pl-7",placeholder:"username","onUpdate:modelValue":l[0]||(l[0]=c=>u("update:modelValue",c.replace(/^@/,"")))},null,8,["name","disabled","model-value"])]),n.checkAvailability?(r(),o("div",E,[a.value?(r(),o("span",F,"Checking availability...")):s.value===!0?(r(),o("span",O,"Username is available.")):s.value===!1?(r(),o("span",X,"Username is not available.")):h("",!0)])):h("",!0),m(_,{message:f.value},null,8,["message"])]))}});export{H as _,D as a};
