import{d as U,j as v,c,a as r,u as t,h as $,w as m,b as s,t as g,l as C,e as i,m as x,q as E,o as S,f as F,v as _,F as B,n as N}from"./app-BwoDBmTi.js";import{_ as n}from"./InputError.vue_vue_type_script_setup_true_lang-D8qotfq0.js";import{_ as V}from"./LoadingButton.vue_vue_type_script_setup_true_lang-DGZMsGfw.js";import{_ as D}from"./index-D21mqHZ5.js";import{_ as f}from"./Input.vue_vue_type_script_setup_true_lang-B5RPFNNU.js";import{_ as A}from"./AppLayout.vue_vue_type_script_setup_true_lang-CCIfOzg-.js";import"./Spinner.vue_vue_type_script_setup_true_lang-BthnRZIA.js";import"./createLucideIcon-BJDOlxJS.js";import"./index-zVmKB-0j.js";import"./index-DEqmV2A2.js";import"./Presence-D5tmvYTh.js";import"./useForwardExpose-C0apztFT.js";import"./useForwardPropsEmits-C4M-NV3R.js";import"./VisuallyHidden-Bt4Wfgfl.js";import"./x-JIVm6lz3.js";import"./index-Dgh_0kKE.js";import"./BottomNav.vue_vue_type_script_setup_true_lang-Rc9wvAIC.js";const R={class:"mx-auto w-full max-w-4xl space-y-4 p-4"},I={class:"flex items-center justify-between"},j={class:"mt-1 text-sm text-muted-foreground"},M={class:"rounded-xl border border-border bg-card p-4 text-sm"},q=["href"],P={class:"rounded-xl border border-border bg-card p-4"},T={class:"grid gap-3"},Y={class:"flex items-center gap-2 text-xs"},z={key:0,class:"rounded-md border border-amber-500/30 bg-amber-500/10 px-3 py-2 text-xs text-amber-600 dark:text-amber-300"},G={class:"grid gap-4 md:grid-cols-2"},H={class:"rounded-xl border border-border bg-card p-4"},J=["disabled"],K={class:"rounded-xl border border-border bg-card p-4"},L=["disabled"],pe=U({__name:"Edit",props:{user:{},currentUserId:{}},setup(u){const o=u,l=v({name:o.user.name,email:o.user.email,username:o.user.username,website:o.user.website??"",is_verified:!!o.user.is_verified,email_verified_at:o.user.email_verified_at?String(o.user.email_verified_at).slice(0,16):""}),p=v({status:o.user.status}),b=v({role:o.user.role}),d=N(()=>o.currentUserId===null||o.currentUserId!==o.user.id),y=()=>{l.put(`/admin/users/${o.user.id}`,{preserveScroll:!0})},k=()=>{d.value&&p.put(`/admin/users/${o.user.id}/status`,{preserveScroll:!0})},w=()=>{d.value&&b.put(`/admin/users/${o.user.id}/role`,{preserveScroll:!0})};return(O,e)=>(S(),c(B,null,[r(t($),{title:`Edit ${u.user.name}`},null,8,["title"]),r(A,null,{default:m(()=>[s("div",R,[s("div",I,[s("div",null,[e[8]||(e[8]=s("h1",{class:"text-2xl font-semibold"},"Edit User",-1)),s("p",j," @"+g(u.user.username),1)]),r(t(C),{href:"/admin/users"},{default:m(()=>[r(t(D),{variant:"outline"},{default:m(()=>[...e[9]||(e[9]=[i("Back to Users",-1)])]),_:1})]),_:1})]),s("div",M,[s("p",null,[e[10]||(e[10]=s("span",{class:"text-muted-foreground"},"University:",-1)),i(" "+g(u.user.university?.name??"Not set"),1)]),s("p",null,[e[11]||(e[11]=s("span",{class:"text-muted-foreground"},"Course:",-1)),i(" "+g(u.user.course?.name??"Not set"),1)]),s("p",null,[e[12]||(e[12]=s("span",{class:"text-muted-foreground"},"Public profile:",-1)),s("a",{href:`/@${u.user.username}`,target:"_blank",rel:"noopener noreferrer",class:"underline underline-offset-4"}," View profile ",8,q)])]),s("div",P,[e[16]||(e[16]=s("h2",{class:"mb-3 text-base font-semibold"},"User Details",-1)),s("div",T,[s("div",null,[r(t(f),{modelValue:t(l).name,"onUpdate:modelValue":e[0]||(e[0]=a=>t(l).name=a),placeholder:"Full name"},null,8,["modelValue"]),r(n,{message:t(l).errors.name},null,8,["message"])]),s("div",null,[r(t(f),{modelValue:t(l).email,"onUpdate:modelValue":e[1]||(e[1]=a=>t(l).email=a),type:"email",placeholder:"Email"},null,8,["modelValue"]),r(n,{message:t(l).errors.email},null,8,["message"])]),s("div",null,[r(t(f),{modelValue:t(l).username,"onUpdate:modelValue":e[2]||(e[2]=a=>t(l).username=a),placeholder:"username"},null,8,["modelValue"]),r(n,{message:t(l).errors.username},null,8,["message"])]),s("div",null,[r(t(f),{modelValue:t(l).website,"onUpdate:modelValue":e[3]||(e[3]=a=>t(l).website=a),placeholder:"example.com"},null,8,["modelValue"]),r(n,{message:t(l).errors.website},null,8,["message"])]),s("label",Y,[x(s("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>t(l).is_verified=a),type:"checkbox"},null,512),[[E,t(l).is_verified]]),e[13]||(e[13]=i(" Verified profile ",-1))]),s("div",null,[e[14]||(e[14]=s("label",{class:"mb-1 block text-xs font-medium text-muted-foreground"}," Email verified at ",-1)),r(t(f),{modelValue:t(l).email_verified_at,"onUpdate:modelValue":e[5]||(e[5]=a=>t(l).email_verified_at=a),type:"datetime-local"},null,8,["modelValue"]),r(n,{message:t(l).errors.email_verified_at},null,8,["message"])]),r(V,{type:"button",loading:t(l).processing,"loading-text":"Saving...",onClick:y},{default:m(()=>[...e[15]||(e[15]=[i(" Save Details ",-1)])]),_:1},8,["loading"])])]),d.value?F("",!0):(S(),c("p",z," You cannot modify your own role or account status. ")),s("div",G,[s("div",H,[e[19]||(e[19]=s("h2",{class:"mb-3 text-base font-semibold"},"Account Status",-1)),x(s("select",{"onUpdate:modelValue":e[6]||(e[6]=a=>t(p).status=a),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm",disabled:!d.value},[...e[17]||(e[17]=[s("option",{value:"active"},"Active",-1),s("option",{value:"suspended"},"Suspended",-1),s("option",{value:"banned"},"Banned",-1)])],8,J),[[_,t(p).status]]),r(n,{message:t(p).errors.status},null,8,["message"]),r(V,{type:"button",class:"mt-3",loading:t(p).processing,"loading-text":"Saving...",disabled:!d.value,onClick:k},{default:m(()=>[...e[18]||(e[18]=[i(" Save Status ",-1)])]),_:1},8,["loading","disabled"])]),s("div",K,[e[22]||(e[22]=s("h2",{class:"mb-3 text-base font-semibold"},"Role",-1)),x(s("select",{"onUpdate:modelValue":e[7]||(e[7]=a=>t(b).role=a),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm",disabled:!d.value},[...e[20]||(e[20]=[s("option",{value:"student"},"Student",-1),s("option",{value:"admin"},"Admin",-1),s("option",{value:"superadmin"},"Superadmin",-1)])],8,L),[[_,t(b).role]]),r(n,{message:t(b).errors.role},null,8,["message"]),r(V,{type:"button",class:"mt-3",loading:t(b).processing,"loading-text":"Saving...",disabled:!d.value,onClick:w},{default:m(()=>[...e[21]||(e[21]=[i(" Save Role ",-1)])]),_:1},8,["loading","disabled"])])])])]),_:1})],64))}});export{pe as default};
