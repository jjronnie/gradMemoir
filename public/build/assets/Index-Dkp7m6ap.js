import{e as U}from"./UserMenuContent.vue_vue_type_script_setup_true_lang-ghQ8lCcE.js";import{_ as j}from"./PhotoCarousel.vue_vue_type_script_setup_true_lang-VcljXTqC.js";import{_ as y}from"./FlashMessages.vue_vue_type_script_setup_true_lang-Bfj-M2-J.js";import{_ as S}from"./AppLayout.vue_vue_type_script_setup_true_lang-D60ySLUZ.js";import{d as A,c as l,a,u as i,h as E,w as d,b as o,l as v,e as m,o as r,F as w,r as D,f as C,t as h,p as $,g as u,n as L,i as O}from"./app-Xw8PJXQX.js";import"./useForwardPropsEmits-C8m6eQjK.js";import"./RovingFocusGroup-BAQMVA2P.js";import"./useForwardExpose-B_D4EoIC.js";import"./index-DRPMKLPy.js";import"./createLucideIcon-Dqvgc3pD.js";import"./index-ueziRkVZ.js";import"./index-CPB1U3Gd.js";import"./VisuallyHidden-Cm9f6LED.js";const R={class:"mx-auto w-full max-w-6xl space-y-6 p-4"},q={class:"flex flex-wrap items-center justify-between gap-2"},Y={key:0,class:"rounded-xl border border-dashed border-border p-8 text-center text-sm text-muted-foreground"},G={key:1,class:"grid gap-4 md:grid-cols-2 xl:grid-cols-3"},H={key:0,class:"grid grid-cols-2 gap-2"},J=["onClick"],K=["src"],Q={class:"text-sm leading-relaxed"},W={class:"space-y-1 text-xs text-muted-foreground"},X={class:"flex flex-wrap items-center gap-2"},Z={class:"flex items-center justify-between"},ee={key:1},fe=A({__name:"Index",props:{posts:{}},setup(M){const c=M,p=u(!1),b=u(!1),f=u(null),g=u(!1),k=u([]),P=u(0),N=L(()=>c.posts.data),V=s=>{if(s===null||s==="")return null;const e=new Date(s);if(Number.isNaN(e.getTime()))return null;const t=Date.now(),n=Math.round((e.getTime()-t)/1e3),_=new Intl.RelativeTimeFormat(void 0,{numeric:"auto"}),z=[{unit:"year",size:31536e3},{unit:"month",size:2592e3},{unit:"week",size:604800},{unit:"day",size:86400},{unit:"hour",size:3600},{unit:"minute",size:60}];for(const x of z)if(Math.abs(n)>=x.size)return _.format(Math.round(n/x.size),x.unit);return _.format(n,"second")},T=s=>{if(s===null||s==="")return"Unknown date";const e=new Date(s);return Number.isNaN(e.getTime())?"Unknown date":e.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})},B=s=>{f.value=s,p.value=!0},F=()=>{f.value!==null&&(b.value=!0,O.delete(`/posts/${f.value}`,{preserveScroll:!0,onFinish:()=>{b.value=!1,p.value=!1,f.value=null}}))},I=(s,e)=>{k.value=s.photos.map(t=>({url:t.full||t.url||t.thumb,full:t.full,thumb:t.thumb,description:s.body,postedDiff:V(s.published_at??s.created_at),postedAt:s.published_at??s.created_at,downloadName:t.file_name})),P.value=e,g.value=!0};return(s,e)=>(r(),l(w,null,[a(i(E),{title:"My Posts"}),a(S,null,{default:d(()=>[o("div",R,[o("div",q,[e[3]||(e[3]=o("div",null,[o("h1",{class:"text-2xl font-semibold"},"My Posts"),o("p",{class:"text-sm text-muted-foreground"}," Manage your uploaded memories. ")],-1)),a(i(v),{href:"/posts/create"},{default:d(()=>[a(i(y),null,{default:d(()=>[...e[2]||(e[2]=[m("Add Photo",-1)])]),_:1})]),_:1})]),N.value.length===0?(r(),l("div",Y," You have not posted anything yet. ")):(r(),l("div",G,[(r(!0),l(w,null,D(N.value,t=>(r(),l("article",{key:t.id,class:"space-y-4 rounded-xl border border-border bg-card p-4"},[t.photos.length>0?(r(),l("div",H,[(r(!0),l(w,null,D(t.photos.slice(0,4),(n,_)=>(r(),l("button",{key:n.id,type:"button",class:"overflow-hidden rounded-md border border-border",onClick:z=>I(t,_)},[o("img",{src:n.thumb||n.full||n.url,alt:"Post photo",class:"aspect-[3/4] w-full object-cover transition-transform duration-200 hover:scale-[1.03]",loading:"lazy"},null,8,K)],8,J))),128))])):C("",!0),o("p",Q,h(t.body||"Photo post"),1),o("div",W,[o("p",null,h(t.published?"Published":"Processing"),1),o("p",null,h(t.photos_count)+" photo(s)",1),o("p",null,"Created "+h(T(t.created_at)),1)]),o("div",X,[a(i(v),{href:`/posts/${t.id}/edit`},{default:d(()=>[a(i(y),{variant:"outline",size:"sm"},{default:d(()=>[...e[4]||(e[4]=[m("Edit",-1)])]),_:1})]),_:1},8,["href"]),a(i(y),{variant:"destructive",size:"sm",onClick:n=>B(t.id)},{default:d(()=>[...e[5]||(e[5]=[m(" Delete ",-1)])]),_:1},8,["onClick"])])]))),128))])),o("section",Z,[c.posts.prev_page_url?(r(),$(i(v),{key:0,href:c.posts.prev_page_url,class:"rounded-md border border-border px-3 py-1.5 text-sm hover:bg-accent"},{default:d(()=>[...e[6]||(e[6]=[m(" Previous ",-1)])]),_:1},8,["href"])):(r(),l("div",ee)),c.posts.next_page_url?(r(),$(i(v),{key:2,href:c.posts.next_page_url,class:"rounded-md border border-border px-3 py-1.5 text-sm hover:bg-accent"},{default:d(()=>[...e[7]||(e[7]=[m(" Next ",-1)])]),_:1},8,["href"])):C("",!0)])]),a(U,{open:p.value,title:"Delete Post",description:"This will permanently delete the post and remove all its photos from storage.","confirm-text":"Delete Post",processing:b.value,"onUpdate:open":e[0]||(e[0]=t=>p.value=t),onConfirm:F},null,8,["open","processing"]),a(j,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=t=>g.value=t),photos:k.value,"initial-index":P.value,title:"Post Photos"},null,8,["modelValue","photos","initial-index"])]),_:1})],64))}});export{fe as default};
