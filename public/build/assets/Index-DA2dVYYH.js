import{_ as O,a as q}from"./UsernameInput.vue_vue_type_script_setup_true_lang-vZco8cyB.js";import{_ as p}from"./InputError.vue_vue_type_script_setup_true_lang-DclnpkCj.js";import{_ as h}from"./LoadingButton.vue_vue_type_script_setup_true_lang-BZdzqf8S.js";import{_ as $}from"./Input.vue_vue_type_script_setup_true_lang-6eVTzFlU.js";import{_ as R}from"./Label.vue_vue_type_script_setup_true_lang-BHs03ZX6.js";import{_ as T}from"./AppLayout.vue_vue_type_script_setup_true_lang-BkC7_KcU.js";import{d as G,g as v,j as H,q as J,c as u,a as n,u as t,h as K,w as f,b as o,t as c,o as i,F as g,r as k,y as C,e as y,f as x,p as S,A as M,n as V,i as Q}from"./app-C4RxZQeq.js";import"./index-2UITHzBk.js";import"./Spinner.vue_vue_type_script_setup_true_lang-CzuqRdQf.js";import"./createLucideIcon-CIIjH0AZ.js";import"./index-Cv2cN02m.js";import"./index-CQCdNE30.js";import"./useForwardExpose-CwMYFS2I.js";import"./Presence-C6NHUOAT.js";import"./useForwardPropsEmits-VfW6L23Z.js";import"./VisuallyHidden-BekQp5so.js";import"./x-BuNzBGro.js";import"./index-Dgh_0kKE.js";import"./BottomNav.vue_vue_type_script_setup_true_lang-DN7C7JYV.js";const W={class:"mx-auto w-full max-w-3xl space-y-6 p-4"},X={class:"space-y-2"},Y={class:"text-sm text-muted-foreground"},Z={class:"grid grid-cols-4 gap-2"},ee={key:0,class:"space-y-4 rounded-xl border border-border bg-card p-4"},re={class:"grid gap-3 md:grid-cols-2"},se=["onClick"],te={class:"font-semibold"},oe={class:"text-sm text-muted-foreground"},le={key:1,class:"space-y-4 rounded-xl border border-border bg-card p-4"},ae={class:"grid gap-3 md:grid-cols-2"},ne=["onClick"],ie={class:"font-semibold"},ue={class:"text-sm text-muted-foreground"},de={key:2,class:"space-y-4 rounded-xl border border-border bg-card p-4"},me={key:3,class:"space-y-4 rounded-xl border border-border bg-card p-4"},ce={class:"flex items-center justify-between"},Be=G({__name:"Index",props:{universities:{},courses:{},selectedUniversityId:{},search:{}},setup(P){const m=P,F=M(),l=v(1),_=v(m.search??""),b=v(""),U=v(null),a=v({university_id:null,course_id:null,username:null}),s=H({university_id:m.selectedUniversityId,course_id:null,username:F.props.auth.user?.username??"",avatar:null}),L=V(()=>_.value.trim()===""?m.universities:m.universities.filter(d=>d.name.toLowerCase().includes(_.value.toLowerCase()))),B=V(()=>{if(b.value.trim()==="")return m.courses;const d=b.value.toLowerCase();return m.courses.filter(e=>`${e.name} ${e.short_name} ${e.year}`.toLowerCase().includes(d))}),N=V(()=>s.username.trim().toLowerCase()),z=/^[a-z0-9_]{3,30}$/;J(()=>s.username,()=>{a.value.username=null});const A=d=>{s.university_id=d,s.course_id=null,a.value.university_id=null,a.value.course_id=null,Q.get("/onboarding",{university_id:d},{preserveState:!0,preserveScroll:!0,replace:!0,only:["courses","selectedUniversityId"]})},w=()=>l.value===1?s.university_id===null?(a.value.university_id="Please select a university.",!1):(a.value.university_id=null,!0):l.value===2?s.course_id===null?(a.value.course_id="Please select a course.",!1):(a.value.course_id=null,!0):l.value===3?z.test(N.value)?U.value!==!0?(a.value.username="Please choose an available username before continuing.",!1):(a.value.username=null,!0):(a.value.username="Username must be 3-30 characters and contain only lowercase letters, numbers, or underscores.",!1):!0,I=()=>{w()&&l.value<4&&(l.value+=1)},j=()=>{l.value>1&&(l.value-=1)},D=()=>{w()&&s.post("/onboarding",{forceFormData:!0})};return(d,e)=>(i(),u(g,null,[n(t(K),{title:"Onboarding"}),n(T,null,{default:f(()=>[o("div",W,[o("div",X,[e[5]||(e[5]=o("h1",{class:"text-2xl font-semibold"},"Complete your profile",-1)),o("p",Y," Step "+c(l.value)+" of 4 ",1),o("div",Z,[(i(),u(g,null,k(4,r=>o("div",{key:r,class:C(["h-1.5 rounded-full",r<=l.value?"bg-primary":"bg-muted"])},null,2)),64))])]),l.value===1?(i(),u("section",ee,[n(t(R),{for:"university-search"},{default:f(()=>[...e[6]||(e[6]=[y("Select University",-1)])]),_:1}),n(t($),{id:"university-search",modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=r=>_.value=r),placeholder:"Search university..."},null,8,["modelValue"]),o("div",re,[(i(!0),u(g,null,k(L.value,r=>(i(),u("button",{key:r.id,type:"button",class:C(["rounded-lg border p-4 text-left hover:border-primary",t(s).university_id===r.id?"border-primary":"border-border"]),onClick:E=>A(r.id)},[o("p",te,c(r.name),1),o("p",oe,c(r.location),1)],10,se))),128))]),n(p,{message:t(s).errors.university_id},null,8,["message"]),n(p,{message:a.value.university_id},null,8,["message"])])):x("",!0),l.value===2?(i(),u("section",le,[e[7]||(e[7]=o("h2",{class:"font-semibold"},"Select Course",-1)),n(t($),{modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=r=>b.value=r),placeholder:"Search course..."},null,8,["modelValue"]),o("div",ae,[(i(!0),u(g,null,k(B.value,r=>(i(),u("button",{key:r.id,type:"button",class:C(["rounded-lg border p-4 text-left hover:border-primary",t(s).course_id===r.id?"border-primary":"border-border"]),onClick:E=>{t(s).course_id=r.id,a.value.course_id=null}},[o("p",ie,c(r.name),1),o("p",ue,c(r.short_name)+" Â· "+c(r.year),1)],10,ne))),128))]),n(p,{message:t(s).errors.course_id},null,8,["message"]),n(p,{message:a.value.course_id},null,8,["message"])])):x("",!0),l.value===3?(i(),u("section",de,[e[8]||(e[8]=o("h2",{class:"font-semibold"},"Choose Username",-1)),n(O,{modelValue:t(s).username,"onUpdate:modelValue":e[2]||(e[2]=r=>t(s).username=r),onAvailability:e[3]||(e[3]=r=>U.value=r)},null,8,["modelValue"]),n(p,{message:a.value.username},null,8,["message"])])):x("",!0),l.value===4?(i(),u("section",me,[e[9]||(e[9]=o("h2",{class:"font-semibold"},"Upload Profile Photo (Optional)",-1)),n(q,{modelValue:t(s).avatar,"onUpdate:modelValue":e[4]||(e[4]=r=>t(s).avatar=r)},null,8,["modelValue"])])):x("",!0),o("div",ce,[n(h,{type:"button",variant:"outline",disabled:l.value===1,loading:t(s).processing,"loading-text":"Please wait...",onClick:j},{default:f(()=>[...e[10]||(e[10]=[y(" Back ",-1)])]),_:1},8,["disabled","loading"]),l.value<4?(i(),S(h,{key:0,type:"button",loading:t(s).processing,"loading-text":"Validating...",onClick:I},{default:f(()=>[...e[11]||(e[11]=[y(" Next ",-1)])]),_:1},8,["loading"])):(i(),S(h,{key:1,loading:t(s).processing,"loading-text":"Finishing...",onClick:D},{default:f(()=>[...e[12]||(e[12]=[y(" Finish ",-1)])]),_:1},8,["loading"]))])])]),_:1})],64))}});export{Be as default};
