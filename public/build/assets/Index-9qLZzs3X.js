import{d as U,c as l,a,u as i,h as j,w as d,b as o,l as v,e as m,o as r,F as y,r as D,f as C,t as h,q as $,g as u,x as S,i as q}from"./app-V76evz6G.js";import{e as A}from"./UserMenuContent.vue_vue_type_script_setup_true_lang-Dr8b2uXp.js";import{_ as E}from"./PhotoCarousel.vue_vue_type_script_setup_true_lang-D_LifwMU.js";import{_ as w}from"./FlashMessages.vue_vue_type_script_setup_true_lang-CRIGBRWp.js";import{_ as L}from"./AppLayout.vue_vue_type_script_setup_true_lang-BCmUAUV4.js";import"./useForwardPropsEmits-Do_0Ola4.js";import"./RovingFocusGroup-C17lhl7u.js";import"./useForwardExpose-FvI28VS4.js";import"./index-hQ9SfOkF.js";import"./createLucideIcon-D8DlfC-D.js";import"./index-ueziRkVZ.js";import"./index-Sn8BDqwf.js";import"./VisuallyHidden-DoVP1t1k.js";const O={class:"mx-auto w-full max-w-6xl space-y-6 p-4"},R={class:"flex flex-wrap items-center justify-between gap-2"},Y={key:0,class:"rounded-xl border border-dashed border-border p-8 text-center text-sm text-muted-foreground"},G={key:1,class:"grid gap-4 md:grid-cols-2 xl:grid-cols-3"},H={key:0,class:"grid grid-cols-2 gap-2"},J=["onClick"],K=["src"],Q={class:"text-sm leading-relaxed"},W={class:"space-y-1 text-xs text-muted-foreground"},X={class:"flex flex-wrap items-center gap-2"},Z={class:"flex items-center justify-between"},ee={key:1},pe=U({__name:"Index",props:{posts:{}},setup(M){const c=M,f=u(!1),x=u(!1),p=u(null),b=u(!1),k=u([]),P=u(0),N=S(()=>c.posts.data),V=s=>{if(s===null||s==="")return null;const e=new Date(s);if(Number.isNaN(e.getTime()))return null;const t=Date.now(),n=Math.round((e.getTime()-t)/1e3),_=new Intl.RelativeTimeFormat(void 0,{numeric:"auto"}),z=[{unit:"year",size:31536e3},{unit:"month",size:2592e3},{unit:"week",size:604800},{unit:"day",size:86400},{unit:"hour",size:3600},{unit:"minute",size:60}];for(const g of z)if(Math.abs(n)>=g.size)return _.format(Math.round(n/g.size),g.unit);return _.format(n,"second")},T=s=>{if(s===null||s==="")return"Unknown date";const e=new Date(s);return Number.isNaN(e.getTime())?"Unknown date":e.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})},B=s=>{p.value=s,f.value=!0},F=()=>{p.value!==null&&(x.value=!0,q.delete(`/posts/${p.value}`,{preserveScroll:!0,onFinish:()=>{x.value=!1,f.value=!1,p.value=null}}))},I=(s,e)=>{k.value=s.photos.map(t=>({url:t.full||t.url||t.thumb,full:t.full,thumb:t.thumb,description:s.body,postedDiff:V(s.published_at??s.created_at),postedAt:s.published_at??s.created_at,downloadName:t.file_name})),P.value=e,b.value=!0};return(s,e)=>(r(),l(y,null,[a(i(j),{title:"My Posts"}),a(L,null,{default:d(()=>[o("div",O,[o("div",R,[e[3]||(e[3]=o("div",null,[o("h1",{class:"text-2xl font-semibold"},"My Posts"),o("p",{class:"text-sm text-muted-foreground"}," Manage your uploaded memories. ")],-1)),a(i(v),{href:"/posts/create"},{default:d(()=>[a(i(w),null,{default:d(()=>[...e[2]||(e[2]=[m("Add Photo",-1)])]),_:1})]),_:1})]),N.value.length===0?(r(),l("div",Y," You have not posted anything yet. ")):(r(),l("div",G,[(r(!0),l(y,null,D(N.value,t=>(r(),l("article",{key:t.id,class:"space-y-4 rounded-xl border border-border bg-card p-4"},[t.photos.length>0?(r(),l("div",H,[(r(!0),l(y,null,D(t.photos.slice(0,4),(n,_)=>(r(),l("button",{key:n.id,type:"button",class:"overflow-hidden rounded-md border border-border",onClick:z=>I(t,_)},[o("img",{src:n.thumb||n.full||n.url,alt:"Post photo",class:"aspect-[3/4] w-full object-cover transition-transform duration-200 hover:scale-[1.03]",loading:"lazy"},null,8,K)],8,J))),128))])):C("",!0),o("p",Q,h(t.body||"Photo post"),1),o("div",W,[o("p",null,h(t.published?"Published":"Processing"),1),o("p",null,h(t.photos_count)+" photo(s)",1),o("p",null,"Created "+h(T(t.created_at)),1)]),o("div",X,[a(i(v),{href:`/posts/${t.id}/edit`},{default:d(()=>[a(i(w),{variant:"outline",size:"sm"},{default:d(()=>[...e[4]||(e[4]=[m("Edit",-1)])]),_:1})]),_:1},8,["href"]),a(i(w),{variant:"destructive",size:"sm",onClick:n=>B(t.id)},{default:d(()=>[...e[5]||(e[5]=[m(" Delete ",-1)])]),_:1},8,["onClick"])])]))),128))])),o("section",Z,[c.posts.prev_page_url?(r(),$(i(v),{key:0,href:c.posts.prev_page_url,class:"rounded-md border border-border px-3 py-1.5 text-sm hover:bg-accent"},{default:d(()=>[...e[6]||(e[6]=[m(" Previous ",-1)])]),_:1},8,["href"])):(r(),l("div",ee)),c.posts.next_page_url?(r(),$(i(v),{key:2,href:c.posts.next_page_url,class:"rounded-md border border-border px-3 py-1.5 text-sm hover:bg-accent"},{default:d(()=>[...e[7]||(e[7]=[m(" Next ",-1)])]),_:1},8,["href"])):C("",!0)])]),a(A,{open:f.value,title:"Delete Post",description:"This will permanently delete the post and remove all its photos from storage.","confirm-text":"Delete Post",processing:x.value,"onUpdate:open":e[0]||(e[0]=t=>f.value=t),onConfirm:F},null,8,["open","processing"]),a(E,{modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=t=>b.value=t),photos:k.value,"initial-index":P.value,title:"Post Photos"},null,8,["modelValue","photos","initial-index"])]),_:1})],64))}});export{pe as default};
