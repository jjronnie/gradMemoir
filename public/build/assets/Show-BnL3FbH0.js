import{a as z,b as F,c as O,_ as S}from"./DialogTitle.vue_vue_type_script_setup_true_lang-uFK_szTC.js";import{d as A,g as y,D as W,A as R,E as J,p as P,w as k,a as _,u as $,e as V,t as d,b as n,c as i,f as c,n as b,o as r,x as X,h as K,l as E,F as j,r as B}from"./app-BwoDBmTi.js";import{_ as q}from"./ShareButton.vue_vue_type_script_setup_true_lang-BZA3dByN.js";import{_ as G}from"./PublicLayout.vue_vue_type_script_setup_true_lang-BxjAwxVk.js";import"./useForwardPropsEmits-C4M-NV3R.js";import"./x-JIVm6lz3.js";import"./useForwardExpose-C0apztFT.js";import"./index-D21mqHZ5.js";import"./Presence-D5tmvYTh.js";import"./createLucideIcon-BJDOlxJS.js";import"./index-DEqmV2A2.js";import"./BottomNav.vue_vue_type_script_setup_true_lang-Rc9wvAIC.js";const H={class:"space-y-4"},Q=["src"],Y={key:0,class:"space-y-1 text-sm text-muted-foreground"},Z={key:0},ee={key:1},te={class:"space-y-1 text-center"},oe={class:"text-xs text-muted-foreground"},le={key:0,class:"text-xs text-muted-foreground"},M=A({__name:"PhotoCarousel",props:{modelValue:{type:Boolean},photos:{},initialIndex:{default:0},title:{default:"Photo"},description:{default:null}},emits:["update:modelValue"],setup(t,{emit:s}){const f=t,g=s,m=y(f.initialIndex),x=y(null);W(()=>f.initialIndex,e=>{m.value=e});const h=b(()=>f.photos.map(e=>typeof e=="string"?{url:e,description:f.description??null,postedDiff:null,postedAt:null,downloadName:null}:{url:e.full??e.url??e.thumb??"",description:e.description??f.description??null,postedDiff:e.postedDiff??null,postedAt:e.postedAt??null,downloadName:e.downloadName??null})),u=b(()=>h.value[m.value]??null),w=b(()=>h.value.length>1),C=()=>{w.value&&(m.value=(m.value-1+h.value.length)%h.value.length)},U=()=>{w.value&&(m.value=(m.value+1)%h.value.length)},N=e=>{!f.modelValue||!w.value||(e.key==="ArrowLeft"&&C(),e.key==="ArrowRight"&&U())},L=e=>{w.value&&(x.value=e.touches[0]?.clientX??null)},D=e=>{if(!w.value||x.value===null)return;const l=e.changedTouches[0]?.clientX;if(typeof l!="number"){x.value=null;return}const a=l-x.value;Math.abs(a)>=40&&(a>0?C():U()),x.value=null},T=e=>{try{const p=new URL(e,window.location.origin).pathname.split("/").pop()??"";return p!==""?p:"photo.webp"}catch{return"photo.webp"}},o=async()=>{if(!u.value||u.value.url==="")return;const e=u.value.url,l=u.value.downloadName??T(e);try{const a=await fetch(e);if(!a.ok)throw new Error("Unable to download image");const p=await a.blob(),I=window.URL.createObjectURL(p),v=document.createElement("a");v.href=I,v.download=l,document.body.appendChild(v),v.click(),v.remove(),window.URL.revokeObjectURL(I)}catch{window.open(e,"_blank","noopener,noreferrer")}};return R(()=>{window.addEventListener("keydown",N)}),J(()=>{window.removeEventListener("keydown",N)}),(e,l)=>(r(),P($(S),{open:t.modelValue,"onUpdate:open":l[0]||(l[0]=a=>g("update:modelValue",a))},{default:k(()=>[_($(z),{class:"scrollbar-hide max-h-[94vh] w-[min(95vw,72rem)] overflow-y-auto"},{default:k(()=>[_($(F),null,{default:k(()=>[_($(O),null,{default:k(()=>[V(d(t.title),1)]),_:1})]),_:1}),n("div",H,[n("div",{class:"overflow-hidden rounded-lg",onTouchstartPassive:L,onTouchendPassive:D},[u.value?.url?(r(),i("img",{key:0,src:u.value.url,alt:"Photo",class:"max-h-[72vh] w-full select-none object-contain",loading:"eager",draggable:"false"},null,8,Q)):c("",!0)],32),u.value?.description||u.value?.postedDiff?(r(),i("div",Y,[u.value?.description?(r(),i("p",Z,d(u.value.description),1)):c("",!0),u.value?.postedDiff?(r(),i("p",ee," Posted "+d(u.value.postedDiff),1)):c("",!0)])):c("",!0),n("div",{class:"flex items-center justify-center"},[n("button",{type:"button",class:"rounded-md border px-4 py-1.5 text-sm hover:bg-accent",onClick:o}," Download ")]),n("div",te,[n("p",oe,d(m.value+1)+" / "+d(h.value.length),1),w.value?(r(),i("p",le," Swipe left or right to browse photos. ")):c("",!0)])])]),_:1})]),_:1},8,["open"]))}}),ne=A({__name:"VerifiedBadgeIcon",props:{class:{}},setup(t){const s=t;return(f,g)=>(r(),i("svg",{viewBox:"0 0 24 24","aria-hidden":"true",class:X(s.class)},[...g[0]||(g[0]=[n("circle",{cx:"12",cy:"12",r:"10",fill:"currentColor"},null,-1),n("path",{d:"M8 12.5 10.7 15 16 9.5",fill:"none",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},null,-1)])],2))}}),se={class:"relative mt-6 overflow-hidden rounded-3xl border border-border bg-card"},re={class:"relative p-5 sm:p-8"},ae={class:"flex flex-col gap-6 sm:flex-row sm:items-end"},ie=["src","alt"],ue={key:1,class:"flex h-full w-full items-center justify-center text-3xl font-semibold text-muted-foreground"},de={class:"min-w-0 flex-1"},ce={class:"flex items-center gap-2"},fe={class:"truncate text-3xl font-semibold sm:text-4xl"},me={class:"mt-1 text-muted-foreground"},pe={class:"mt-3 flex flex-wrap items-center gap-3 text-sm"},he={key:0},ve={key:1,class:"inline-flex items-center gap-1 text-muted-foreground"},be={class:"mt-2 space-y-2 text-sm text-muted-foreground"},ge=["src","alt"],xe={key:2,class:"flex items-center gap-1 text-muted-foreground"},we={key:0,class:"mt-6 max-w-3xl text-sm leading-relaxed text-muted-foreground"},ye={class:"mt-6 flex flex-wrap gap-2"},ke=["href","aria-label"],_e={class:"mt-6 pb-10"},$e={class:"grid grid-cols-2 gap-3 md:grid-cols-3 lg:grid-cols-4"},Ce=["onClick"],Ne=["src"],De={key:0,class:"rounded-xl border border-dashed border-border p-6 text-center text-sm text-muted-foreground"},Xe=A({__name:"Show",props:{profile:{},posts:{}},setup(t){const s=t,f=y(!1),g=y(!1),m=y([]),x=y(0),h=y(""),u=b(()=>s.profile.media?.[0]?.conversions?.full??s.profile.media?.[0]?.original_url??null),w=b(()=>s.profile.name.trim().charAt(0).toUpperCase()||"U"),C=b(()=>{const o=s.profile.location?.trim()??"";return o===""?null:o.length>15?`${o.slice(0,15)}...`:o}),U=b(()=>{const o=[];return s.profile.phone&&o.push({key:"whatsapp",href:`https://wa.me/${s.profile.phone}`,iconClass:"fa-brands fa-whatsapp",label:"WhatsApp"}),s.profile.instagram_username&&o.push({key:"instagram",href:`https://instagram.com/${s.profile.instagram_username}`,iconClass:"fa-brands fa-instagram",label:"Instagram"}),s.profile.tiktok_username&&o.push({key:"tiktok",href:`https://tiktok.com/@${s.profile.tiktok_username}`,iconClass:"fa-brands fa-tiktok",label:"TikTok"}),s.profile.x_username&&o.push({key:"x",href:`https://x.com/${s.profile.x_username.replace(/^@/,"")}`,iconClass:"fa-brands fa-x-twitter",label:"X"}),s.profile.facebook_username&&o.push({key:"facebook",href:`https://facebook.com/${s.profile.facebook_username}`,iconClass:"fa-brands fa-facebook",label:"Facebook"}),s.profile.email_public&&o.push({key:"email",href:`mailto:${s.profile.email_public}`,iconClass:"fa-solid fa-envelope",label:"Email"}),s.profile.website&&o.push({key:"website",href:`https://${s.profile.website}`,iconClass:"fa-solid fa-globe",label:"Website"}),o}),N=b(()=>{if(!s.profile.created_at)return null;const o=new Date(s.profile.created_at);return Number.isNaN(o.getTime())?null:o.toLocaleDateString(void 0,{year:"numeric",month:"long"})}),L=o=>{if(o===null||o==="")return null;const e=new Date(o);if(Number.isNaN(e.getTime()))return null;const l=Date.now(),a=Math.round((e.getTime()-l)/1e3),p=new Intl.RelativeTimeFormat(void 0,{numeric:"auto"}),I=[{unit:"year",seconds:31536e3},{unit:"month",seconds:2592e3},{unit:"week",seconds:604800},{unit:"day",seconds:86400},{unit:"hour",seconds:3600},{unit:"minute",seconds:60}];for(const v of I)if(Math.abs(a)>=v.seconds)return p.format(Math.round(a/v.seconds),v.unit);return p.format(a,"second")},D=b(()=>s.posts.data.flatMap(o=>{const e=o.published_at??o.created_at,l=L(e);return(o.media??[]).map((a,p)=>({id:`${o.id}-${p}`,thumb:a.conversions?.thumb??a.conversions?.full??a.original_url??"",full:a.conversions?.full??a.conversions?.thumb??a.original_url??"",description:o.body,postedDiff:l,postedAt:e,downloadName:`@${s.profile.username}-photo-${o.id}-${p+1}.webp`}))})),T=o=>{m.value=D.value.filter(l=>l.full!=="");const e=m.value.findIndex(l=>l.full===o);x.value=e>=0?e:0,f.value=!0};return R(()=>{h.value=window.location.href}),(o,e)=>(r(),i(j,null,[_($(K),{title:`${t.profile.name} | ${o.$page.props.appName}`},null,8,["title"]),_(G,null,{default:k(()=>[n("section",se,[e[6]||(e[6]=n("div",{class:"absolute inset-0 bg-gradient-to-br from-primary/10 via-transparent to-transparent"},null,-1)),n("div",re,[n("div",ae,[n("button",{type:"button",class:"h-28 w-28 shrink-0 overflow-hidden rounded-full border border-border bg-muted sm:h-32 sm:w-32",onClick:e[0]||(e[0]=l=>g.value=!0)},[u.value?(r(),i("img",{key:0,src:u.value,alt:t.profile.name,class:"h-full w-full object-cover",loading:"lazy"},null,8,ie)):(r(),i("div",ue,d(w.value),1))]),n("div",de,[n("div",ce,[n("h1",fe,d(t.profile.name),1),t.profile.is_verified?(r(),P(ne,{key:0,class:"size-5 shrink-0 text-primary"})):c("",!0)]),n("p",me," @"+d(t.profile.username),1),n("div",pe,[t.profile.profession?(r(),i("span",he,d(t.profile.profession),1)):c("",!0),C.value?(r(),i("span",ve,[e[3]||(e[3]=n("i",{class:"fa-solid fa-location-dot"},null,-1)),V(" "+d(C.value),1)])):c("",!0)]),n("div",be,[t.profile.university?.name&&t.profile.university?.slug?(r(),P($(E),{key:0,href:`/universities/${t.profile.university.slug}`,class:"flex items-center gap-1 text-muted-foreground hover:text-muted-foreground"},{default:k(()=>[t.profile.university.media?.[0]?.conversions?.thumb||t.profile.university.media?.[0]?.original_url?(r(),i("img",{key:0,src:t.profile.university.media?.[0]?.conversions?.full??t.profile.university.media?.[0]?.conversions?.thumb??t.profile.university.media?.[0]?.original_url??"",alt:t.profile.university.name??"University logo",class:"h-4 w-4 object-cover"},null,8,ge)):c("",!0),V(" "+d(t.profile.university.name),1)]),_:1},8,["href"])):c("",!0),t.profile.course?.short_name&&t.profile.course?.year&&t.profile.course?.slug?(r(),P($(E),{key:1,href:`/courses/${t.profile.course.slug}`,class:"flex items-center gap-1 text-muted-foreground hover:text-muted-foreground"},{default:k(()=>[e[4]||(e[4]=n("i",{class:"fa-solid fa-graduation-cap"},null,-1)),V(" "+d(t.profile.course.short_name)+" Class of "+d(t.profile.course.year),1)]),_:1},8,["href"])):c("",!0),N.value?(r(),i("span",xe,[e[5]||(e[5]=n("i",{class:"fa-regular fa-calendar"},null,-1)),V(" Joined "+d(N.value),1)])):c("",!0)])])]),t.profile.bio?(r(),i("p",we,d(t.profile.bio),1)):c("",!0),n("div",ye,[(r(!0),i(j,null,B(U.value,l=>(r(),i("a",{key:l.key,href:l.href,target:"_blank",rel:"noopener noreferrer","aria-label":l.label,class:"inline-flex items-center gap-2 rounded-full border border-border bg-background px-3 py-1.5 text-sm hover:bg-accent"},[n("i",{class:X(l.iconClass)},null,2),n("span",null,d(l.label),1)],8,ke))),128))])])]),n("section",_e,[e[7]||(e[7]=n("h2",{class:"mb-3 text-lg font-semibold"},"Photos",-1)),n("div",$e,[(r(!0),i(j,null,B(D.value,l=>(r(),i("button",{key:l.id,type:"button",class:"group overflow-hidden border border-border bg-card text-left",onClick:a=>T(l.full)},[n("img",{src:l.thumb,alt:"Post image",class:"aspect-[3/4] w-full object-cover transition-transform duration-200 group-hover:scale-[1.03]",loading:"lazy"},null,8,Ne)],8,Ce))),128))]),D.value.length===0?(r(),i("div",De," No photos published yet. ")):c("",!0)]),_(q,{url:h.value,title:t.profile.name},null,8,["url","title"]),_(M,{modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=l=>f.value=l),photos:m.value,"initial-index":x.value},null,8,["modelValue","photos","initial-index"]),u.value?(r(),P(M,{key:0,modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=l=>g.value=l),photos:[u.value],title:"Profile Photo"},null,8,["modelValue","photos"])):c("",!0)]),_:1})],64))}});export{Xe as default};
