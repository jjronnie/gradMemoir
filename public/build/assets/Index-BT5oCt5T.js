import{d as de,j as W,g as n,p as ie,c as l,a as i,u as v,h as ue,w as c,b as e,t as u,o,F as _,r as S,q as D,e as C,s as M,f as b,x as h,i as L}from"./app-BXlxvPJ4.js";import{_ as ce,a as me,b as fe,c as pe,e as ge}from"./UserMenuContent.vue_vue_type_script_setup_true_lang-D9b9PEsY.js";import{_ as Q}from"./InputError.vue_vue_type_script_setup_true_lang-DDcA0SiJ.js";import{_ as R}from"./LoadingButton.vue_vue_type_script_setup_true_lang-HJHBRm1v.js";import{_ as ve}from"./Input.vue_vue_type_script_setup_true_lang-Bhhprupd.js";import{_ as xe}from"./AppLayout.vue_vue_type_script_setup_true_lang-DG7I23hc.js";import"./useForwardPropsEmits-CYY9JK-I.js";import"./RovingFocusGroup-DWhwfIpB.js";import"./FlashMessages.vue_vue_type_script_setup_true_lang-HONSxRlG.js";import"./useForwardExpose-COt-7_XK.js";import"./index-BB3w2Cxu.js";import"./createLucideIcon-BhpRTv15.js";import"./index-ueziRkVZ.js";import"./Spinner.vue_vue_type_script_setup_true_lang-DuwWGKtl.js";import"./index-C78dSs6T.js";import"./VisuallyHidden-C9aoMcVK.js";const _e={class:"space-y-4 p-4"},be={class:"rounded-xl border border-border bg-card p-5"},he={class:"mb-4 flex flex-col gap-1 border-b border-border pb-4 md:flex-row md:items-center md:justify-between"},ye={class:"text-sm text-muted-foreground"},ke={class:"grid gap-5 xl:grid-cols-[minmax(0,1.35fr),minmax(0,1fr)]"},we={class:"space-y-4"},Fe={class:"space-y-2"},Se={class:"space-y-1"},Ce={class:"overflow-hidden rounded-xl border border-border bg-muted/20"},Pe=["src"],Ue={key:1,class:"flex h-[24rem] items-center justify-center px-4 text-center text-sm text-muted-foreground"},Ie={key:0,class:"grid grid-cols-5 gap-2"},$e=["onClick"],je=["src"],Re={class:"space-y-3"},Ae={key:0,class:"grid max-h-[33rem] grid-cols-3 gap-2 overflow-y-auto pr-1 sm:grid-cols-4 lg:grid-cols-6"},Ve=["onClick"],Ne=["src"],ze={key:1,class:"flex h-16 w-full items-center justify-center rounded bg-muted text-[10px] text-muted-foreground"},Ee={class:"mt-1 flex items-center justify-between gap-1"},De=["disabled","onClick"],Le={key:1,class:"rounded-lg border border-dashed border-border p-6 text-center text-sm text-muted-foreground"},Te={class:"rounded-xl border border-border bg-card p-4"},Oe={key:0,class:"mt-4 grid gap-3 md:grid-cols-2 xl:grid-cols-3"},qe={class:"flex items-start gap-3"},Be=["src","alt"],We={key:1,class:"flex h-12 w-12 items-center justify-center rounded bg-muted text-xs text-muted-foreground"},Me={class:"min-w-0 flex-1"},Qe={class:"truncate text-sm font-semibold"},Ge={class:"truncate text-xs text-muted-foreground"},He={class:"truncate text-xs text-muted-foreground"},Je={class:"mt-3 flex flex-wrap gap-2"},Ke=["href"],Xe={key:0,class:"text-sm text-muted-foreground"},Ye={class:"rounded-xl border border-border bg-card p-4"},Ze={key:0,class:"mb-3 text-xs text-amber-600"},et={key:1,class:"overflow-x-auto rounded-lg border border-border"},tt={class:"min-w-full text-left text-sm"},st={class:"px-4 py-3"},rt={class:"px-4 py-3"},ot=["src","alt"],lt={key:1,class:"flex h-10 w-10 items-center justify-center rounded bg-muted text-xs text-muted-foreground"},at={class:"px-4 py-3 font-medium"},nt={class:"px-4 py-3 text-muted-foreground"},dt={class:"px-4 py-3 text-muted-foreground"},it={class:"px-4 py-3"},ut={class:"flex flex-wrap gap-2"},ct=["href"],mt={key:2,class:"text-sm text-muted-foreground"},ft={class:"space-y-2"},pt={class:"overflow-hidden rounded-lg border border-border bg-muted/20"},gt=["src"],vt={class:"text-xs text-muted-foreground"},Vt=de({__name:"Index",props:{featuredProfiles:{},featuredImages:{},search:{},searchResults:{}},setup(m){const T=m,P=W({user_id:""}),f=W({images:[]}),U=n(T.search),I=n(null),y=n(null),k=n(null),A=n(!1),x=n([]),w=n(0),V=n(null),N=n(!1),z=n(null),O=n(""),p=n(!1),$=n(""),j=n(""),a=n(null),G=h(()=>T.featuredImages.length),q=h(()=>x.value[w.value]??null),H=h(()=>Object.entries(f.errors).filter(([r,s])=>(r==="images"||r.startsWith("images."))&&typeof s=="string"&&s.trim()!=="").map(([,r])=>r)),J=h(()=>a.value?.type==="add"?"Add":"Remove"),K=h(()=>a.value?.type==="add"?"default":"destructive"),X=h(()=>I.value!==null||y.value!==null||k.value!==null);let F=null;const Y=()=>{F!==null&&clearTimeout(F),F=setTimeout(()=>{L.get("/admin/featured-profiles",{search:U.value},{preserveState:!0,preserveScroll:!0,replace:!0})},300)},g=r=>r?.[0]?.conversions?.thumb??r?.[0]?.conversions?.full??r?.[0]?.original_url??null,Z=r=>r==null||r===""?"Unknown date":new Date(r).toLocaleString(),E=()=>{x.value.forEach(r=>{URL.revokeObjectURL(r)}),x.value=[]},ee=()=>{E(),f.reset("images"),w.value=0,V.value!==null&&(V.value.value="")},te=r=>{f.clearErrors();const s=r.target,t=Array.from(s.files??[]);E(),f.images=t,x.value=t.map(d=>URL.createObjectURL(d)),w.value=0},se=r=>{w.value=r},re=r=>{const s=g(r.media);s!==null&&(z.value=s,O.value=Z(r.created_at),N.value=!0)},oe=()=>{if(f.clearErrors(),f.images.length===0){f.setError("images","Please select at least one image.");return}A.value=!0,f.post("/admin/featured-profiles/images",{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{ee()},onFinish:()=>{A.value=!1}})},le=r=>{a.value={type:"add",user:r},$.value="Add Featured Profile",j.value=`Add ${r.name} to featured profiles?`,p.value=!0},B=r=>{a.value={type:"remove",id:r},$.value="Remove Featured Profile",j.value="Remove this profile from the featured list?",p.value=!0},ae=r=>{a.value={type:"remove-image",id:r},$.value="Remove Featured Image",j.value="Delete this featured image?",p.value=!0},ne=()=>{if(a.value!==null){if(a.value.type==="add"){const r=a.value.user;P.clearErrors(),P.user_id=String(r.id),I.value=r.id,P.post("/admin/featured-profiles",{preserveScroll:!0,onFinish:()=>{I.value=null,p.value=!1,a.value=null}});return}if(a.value.type==="remove"){y.value=a.value.id,L.delete(`/admin/featured-profiles/${a.value.id}`,{preserveScroll:!0,onFinish:()=>{y.value=null,p.value=!1,a.value=null}});return}k.value=a.value.id,L.delete(`/admin/featured-profiles/images/${a.value.id}`,{preserveScroll:!0,onFinish:()=>{k.value=null,p.value=!1,a.value=null}})}};return ie(()=>{E(),F!==null&&clearTimeout(F)}),(r,s)=>(o(),l(_,null,[i(v(ue),{title:"Featured Profiles"}),i(xe,null,{default:c(()=>[e("div",_e,[s[12]||(s[12]=e("h1",{class:"text-2xl font-semibold"},"Featured Profiles",-1)),e("div",be,[e("div",he,[s[3]||(s[3]=e("div",null,[e("h2",{class:"text-lg font-semibold"},"Featured Image Studio"),e("p",{class:"text-sm text-muted-foreground"}," Select images to upload. Validation errors will appear below. ")],-1)),e("p",ye,u(G.value)+" uploaded total ",1)]),e("div",ke,[e("section",we,[e("div",Fe,[s[5]||(s[5]=e("label",{class:"block text-sm font-medium"}," Upload featured images ",-1)),e("input",{ref_key:"featuredImageInput",ref:V,type:"file",multiple:"",accept:"image/jpeg,image/png,image/webp,image/gif,image/avif",class:"block w-full cursor-pointer rounded-md border border-input bg-background px-3 py-2 text-sm",onChange:te},null,544),e("div",Se,[(o(!0),l(_,null,S(H.value,(t,d)=>(o(),D(Q,{key:`featured-image-error-${d}`,message:t},null,8,["message"]))),128))]),i(R,{type:"button",loading:A.value,"loading-text":"Uploading...",onClick:oe},{default:c(()=>[...s[4]||(s[4]=[C(" Upload Selected Images ",-1)])]),_:1},8,["loading"])]),e("div",Ce,[q.value?(o(),l("img",{key:0,src:q.value,alt:"Selected featured image preview",class:"h-[24rem] w-full object-contain"},null,8,Pe)):(o(),l("div",Ue," Full-size preview appears here after selecting images. "))]),x.value.length>0?(o(),l("div",Ie,[(o(!0),l(_,null,S(x.value,(t,d)=>(o(),l("button",{key:t,type:"button",class:M(["overflow-hidden rounded-md border transition hover:opacity-90",w.value===d?"border-primary ring-2 ring-primary/40":"border-border"]),onClick:xt=>se(d)},[e("img",{src:t,alt:"Selected preview thumbnail",class:"h-16 w-full object-cover"},null,8,je)],10,$e))),128))])):b("",!0)]),e("section",Re,[s[6]||(s[6]=e("div",{class:"flex items-center justify-between"},[e("h3",{class:"text-sm font-semibold uppercase tracking-wide text-muted-foreground"}," Uploaded "),e("p",{class:"text-xs text-muted-foreground"}," Click thumbnail to view full image ")],-1)),m.featuredImages.length>0?(o(),l("div",Ae,[(o(!0),l(_,null,S(m.featuredImages,t=>(o(),l("article",{key:t.id,class:"rounded-md border border-border bg-background p-2"},[e("button",{type:"button",class:"block w-full",onClick:d=>re(t)},[g(t.media)?(o(),l("img",{key:0,src:g(t.media)??"",alt:"Uploaded featured image",class:"h-16 w-full rounded object-cover",loading:"lazy"},null,8,Ne)):(o(),l("div",ze," N/A "))],8,Ve),e("div",Ee,[e("p",{class:M(["text-[10px]",t.is_ready?"text-emerald-600":"text-amber-600"])},u(t.is_ready?"Ready":"Processing"),3),e("button",{type:"button",class:"text-[10px] font-medium text-red-600 hover:underline disabled:opacity-50",disabled:k.value===t.id,onClick:d=>ae(t.id)},u(k.value===t.id?"...":"Delete"),9,De)])]))),128))])):(o(),l("p",Le," No featured images uploaded yet. "))])])]),e("div",Te,[s[9]||(s[9]=e("label",{class:"mb-2 block text-sm font-medium"},"Search users to add/remove",-1)),i(v(ve),{modelValue:U.value,"onUpdate:modelValue":s[0]||(s[0]=t=>U.value=t),placeholder:"Search by name, username, or email...",onInput:Y},null,8,["modelValue"]),i(Q,{message:v(P).errors.user_id,class:"mt-2"},null,8,["message"]),U.value.trim()!==""?(o(),l("div",Oe,[(o(!0),l(_,null,S(m.searchResults,t=>(o(),l("article",{key:t.id,class:"rounded-lg border border-border p-3"},[e("div",qe,[g(t.media)?(o(),l("img",{key:0,src:g(t.media)??"",alt:t.name,class:"h-12 w-12 rounded object-cover",loading:"lazy"},null,8,Be)):(o(),l("div",We," N/A ")),e("div",Me,[e("p",Qe,u(t.name),1),e("p",Ge," @"+u(t.username),1),e("p",He,u(t.email),1)])]),e("div",Je,[e("a",{href:`/@${t.username}`,target:"_blank",rel:"noopener noreferrer",class:"inline-flex h-8 items-center rounded-md border border-border px-3 text-xs hover:bg-accent"}," Show ",8,Ke),t.featured_profile?(o(),D(R,{key:1,type:"button",size:"sm",variant:"destructive",loading:y.value===t.featured_profile.id,"loading-text":"Removing...",onClick:d=>B(t.featured_profile.id)},{default:c(()=>[...s[8]||(s[8]=[C(" Remove ",-1)])]),_:1},8,["loading","onClick"])):(o(),D(R,{key:0,type:"button",size:"sm",loading:I.value===t.id,"loading-text":"Adding...",onClick:d=>le(t)},{default:c(()=>[...s[7]||(s[7]=[C(" Add ",-1)])]),_:1},8,["loading","onClick"]))])]))),128)),m.searchResults.length===0?(o(),l("p",Xe," No matching users found. ")):b("",!0)])):b("",!0)]),e("div",Ye,[m.featuredProfiles.data.length>20?(o(),l("p",Ze," Warning: more than 20 featured profiles may reduce homepage quality. ")):b("",!0),m.featuredProfiles.data.length>0?(o(),l("div",et,[e("table",tt,[s[11]||(s[11]=e("thead",{class:"bg-muted/40 text-xs tracking-wide text-muted-foreground uppercase"},[e("tr",null,[e("th",{class:"px-4 py-3"},"Order"),e("th",{class:"px-4 py-3"},"Photo"),e("th",{class:"px-4 py-3"},"Name"),e("th",{class:"px-4 py-3"},"Username"),e("th",{class:"px-4 py-3"},"Email"),e("th",{class:"px-4 py-3"},"Actions")])],-1)),e("tbody",null,[(o(!0),l(_,null,S(m.featuredProfiles.data,t=>(o(),l("tr",{key:t.id,class:"border-t border-border align-middle"},[e("td",st,u(t.sort_order),1),e("td",rt,[g(t.user?.media)?(o(),l("img",{key:0,src:g(t.user?.media)??"",alt:t.user?.name??"Profile photo",class:"h-10 w-10 rounded object-cover",loading:"lazy"},null,8,ot)):(o(),l("div",lt," N/A "))]),e("td",at,u(t.user?.name??"Unknown user"),1),e("td",nt," @"+u(t.user?.username),1),e("td",dt,u(t.user?.email),1),e("td",it,[e("div",ut,[t.user?.username?(o(),l("a",{key:0,href:`/@${t.user.username}`,target:"_blank",rel:"noopener noreferrer",class:"inline-flex h-8 items-center rounded-md border border-border px-3 text-xs hover:bg-accent"}," Show ",8,ct)):b("",!0),i(R,{type:"button",size:"sm",variant:"destructive",loading:y.value===t.id,"loading-text":"Removing...",onClick:d=>B(t.id)},{default:c(()=>[...s[10]||(s[10]=[C(" Remove ",-1)])]),_:1},8,["loading","onClick"])])])]))),128))])])])):(o(),l("p",mt," No featured profiles yet. "))])]),i(v(ce),{open:N.value,"onUpdate:open":s[1]||(s[1]=t=>N.value=t)},{default:c(()=>[i(v(me),{class:"max-w-4xl"},{default:c(()=>[i(v(fe),null,{default:c(()=>[i(v(pe),null,{default:c(()=>[...s[13]||(s[13]=[C("Featured Image",-1)])]),_:1})]),_:1}),e("div",ft,[e("div",pt,[z.value?(o(),l("img",{key:0,src:z.value,alt:"Featured image full view",class:"max-h-[70vh] w-full object-contain"},null,8,gt)):b("",!0)]),e("p",vt," Uploaded "+u(O.value),1)])]),_:1})]),_:1},8,["open"]),i(ge,{open:p.value,title:$.value,description:j.value,"confirm-text":J.value,"confirm-variant":K.value,processing:X.value,"onUpdate:open":s[2]||(s[2]=t=>p.value=t),onConfirm:ne},null,8,["open","title","description","confirm-text","confirm-variant","processing"])]),_:1})],64))}});export{Vt as default};
