import{d as F,j as U,n as E,c as i,a as r,u as s,h as P,w as a,b as o,k as N,e as u,m as h,o as l,F as y,r as x,t as _,v as C,f as B,g as D,i as M}from"./app-DW2KkjvG.js";import{_ as f}from"./InputError.vue_vue_type_script_setup_true_lang-BltmWT9M.js";import{_ as S}from"./LoadingButton.vue_vue_type_script_setup_true_lang-B7F_b-eQ.js";import{_ as k}from"./Input.vue_vue_type_script_setup_true_lang--CnlkcD7.js";import{_ as b}from"./Label.vue_vue_type_script_setup_true_lang-_4_XZR1r.js";import{_ as j}from"./AppLayout.vue_vue_type_script_setup_true_lang-CPtdiE_o.js";import"./FlashMessages.vue_vue_type_script_setup_true_lang-DzlBP8Dr.js";import"./Spinner.vue_vue_type_script_setup_true_lang-Bs6myhA4.js";import"./createLucideIcon-DK4FZEuV.js";import"./index-DDc9h_z2.js";import"./index-BafghysU.js";import"./useForwardExpose-Bu8G4Clg.js";import"./RovingFocusGroup-DlkB2bT6.js";import"./UserMenuContent.vue_vue_type_script_setup_true_lang-CGOEXzev.js";import"./useForwardPropsEmits-Dt7zh49w.js";import"./index-ueziRkVZ.js";import"./VisuallyHidden-BooNPzSY.js";const z={class:"mx-auto max-w-4xl space-y-4 p-4"},L={class:"grid gap-2"},T=["value"],q={class:"grid gap-2"},G={class:"grid gap-2 md:grid-cols-2"},H={class:"grid gap-2"},J={class:"grid gap-2"},K={class:"space-y-4 rounded-xl border border-border bg-card p-4"},O={class:"grid gap-2"},Q={class:"grid gap-2"},R=["value"],W={class:"self-end"},X={class:"rounded-lg border border-border/60"},Z={class:"w-full text-sm"},I={class:"px-3 py-2"},Y={class:"px-3 py-2 font-mono text-xs"},ee={class:"px-3 py-2"},oe=["onUpdate:modelValue"],se=["value"],te={class:"px-3 py-2"},re={class:"flex items-center gap-2"},de=["href"],ne={key:0},Ce=F({__name:"Edit",props:{course:{},universities:{},admins:{}},setup(c){const p=c,d=U({university_id:p.course.university_id,name:p.course.name,short_name:p.course.short_name,nickname:p.course.nickname??""}),m=U({year:"",admin_id:""}),v=E(p.course.course_years.reduce((n,e)=>({...n,[e.id]:e.admin_id??""}),{})),V=D(null),$=()=>{d.put(`/admin/courses/${p.course.id}`)},w=()=>{m.transform(n=>({...n,admin_id:n.admin_id===""?null:n.admin_id})).post(`/admin/courses/${p.course.id}/course-years`,{preserveScroll:!0,onSuccess:()=>{m.reset()}})},A=n=>{V.value=n,M.put(`/admin/course-years/${n}/admin`,{admin_id:v[n]===""?null:v[n]},{preserveScroll:!0,onFinish:()=>{V.value=null}})};return(n,e)=>(l(),i(y,null,[r(s(P),{title:"Edit Program"}),r(j,null,{default:a(()=>[o("div",z,[e[20]||(e[20]=o("h1",{class:"text-2xl font-semibold"},"Edit Program",-1)),o("form",{class:"space-y-4 rounded-xl border border-border bg-card p-4",onSubmit:N($,["prevent"])},[o("div",L,[r(s(b),{for:"university_id"},{default:a(()=>[...e[6]||(e[6]=[u("University",-1)])]),_:1}),h(o("select",{id:"university_id","onUpdate:modelValue":e[0]||(e[0]=t=>s(d).university_id=t),class:"rounded-md border border-input bg-background px-3 py-2 text-sm"},[(l(!0),i(y,null,x(c.universities,t=>(l(),i("option",{key:t.id,value:t.id},_(t.name),9,T))),128))],512),[[C,s(d).university_id]]),r(f,{message:s(d).errors.university_id},null,8,["message"])]),o("div",q,[r(s(b),{for:"name"},{default:a(()=>[...e[7]||(e[7]=[u("Program Name",-1)])]),_:1}),r(s(k),{id:"name",modelValue:s(d).name,"onUpdate:modelValue":e[1]||(e[1]=t=>s(d).name=t)},null,8,["modelValue"]),r(f,{message:s(d).errors.name},null,8,["message"])]),o("div",G,[o("div",H,[r(s(b),{for:"short_name"},{default:a(()=>[...e[8]||(e[8]=[u("Short Name",-1)])]),_:1}),r(s(k),{id:"short_name",modelValue:s(d).short_name,"onUpdate:modelValue":e[2]||(e[2]=t=>s(d).short_name=t)},null,8,["modelValue"]),r(f,{message:s(d).errors.short_name},null,8,["message"])]),o("div",J,[r(s(b),{for:"nickname"},{default:a(()=>[...e[9]||(e[9]=[u("Nickname (optional)",-1)])]),_:1}),r(s(k),{id:"nickname",modelValue:s(d).nickname,"onUpdate:modelValue":e[3]||(e[3]=t=>s(d).nickname=t),placeholder:"e.g. Computer Science"},null,8,["modelValue"]),r(f,{message:s(d).errors.nickname},null,8,["message"])])]),r(S,{type:"submit",loading:s(d).processing,"loading-text":"Updating..."},{default:a(()=>[...e[10]||(e[10]=[u(" Update Program ",-1)])]),_:1},8,["loading"])],32),o("section",K,[e[19]||(e[19]=o("h2",{class:"text-lg font-semibold"},"Cohorts",-1)),o("form",{class:"grid gap-3 rounded-lg border border-border/60 p-3 md:grid-cols-[1fr_1fr_auto]",onSubmit:N(w,["prevent"])},[o("div",O,[r(s(b),{for:"year"},{default:a(()=>[...e[11]||(e[11]=[u("Year",-1)])]),_:1}),r(s(k),{id:"year",modelValue:s(m).year,"onUpdate:modelValue":e[4]||(e[4]=t=>s(m).year=t),placeholder:"2026",maxlength:"4"},null,8,["modelValue"]),r(f,{message:s(m).errors.year},null,8,["message"])]),o("div",Q,[r(s(b),{for:"cohort_admin_id"},{default:a(()=>[...e[12]||(e[12]=[u("Assign Admin (optional)",-1)])]),_:1}),h(o("select",{id:"cohort_admin_id","onUpdate:modelValue":e[5]||(e[5]=t=>s(m).admin_id=t),class:"rounded-md border border-input bg-background px-3 py-2 text-sm"},[e[13]||(e[13]=o("option",{value:""},"No admin assigned",-1)),(l(!0),i(y,null,x(c.admins,t=>(l(),i("option",{key:t.id,value:t.id},_(t.name)+" ("+_(t.email)+") ",9,R))),128))],512),[[C,s(m).admin_id]]),r(f,{message:s(m).errors.admin_id},null,8,["message"])]),o("div",W,[r(S,{type:"submit",loading:s(m).processing,"loading-text":"Creating..."},{default:a(()=>[...e[14]||(e[14]=[u(" Add Cohort ",-1)])]),_:1},8,["loading"])])],32),o("div",X,[o("table",Z,[e[18]||(e[18]=o("thead",null,[o("tr",{class:"border-b border-border text-left"},[o("th",{class:"px-3 py-2"},"Year"),o("th",{class:"px-3 py-2"},"Slug"),o("th",{class:"px-3 py-2"},"Admin"),o("th",{class:"px-3 py-2"},"Actions")])],-1)),o("tbody",null,[(l(!0),i(y,null,x(c.course.course_years,t=>(l(),i("tr",{key:t.id,class:"border-b border-border/50"},[o("td",I,"Class of "+_(t.year),1),o("td",Y,_(t.slug),1),o("td",ee,[h(o("select",{"onUpdate:modelValue":g=>v[t.id]=g,class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},[e[15]||(e[15]=o("option",{value:""},"No admin assigned",-1)),(l(!0),i(y,null,x(c.admins,g=>(l(),i("option",{key:g.id,value:g.id},_(g.name)+" ("+_(g.email)+") ",9,se))),128))],8,oe),[[C,v[t.id]]])]),o("td",te,[o("div",re,[r(S,{type:"button",size:"sm",loading:V.value===t.id,"loading-text":"Saving...",onClick:g=>A(t.id)},{default:a(()=>[...e[16]||(e[16]=[u(" Save ",-1)])]),_:1},8,["loading","onClick"]),o("a",{href:`/${t.slug}`,target:"_blank",rel:"noopener noreferrer",class:"inline-flex h-8 items-center rounded-md border border-border px-3 text-xs hover:bg-accent"}," View ",8,de)])])]))),128)),c.course.course_years.length===0?(l(),i("tr",ne,[...e[17]||(e[17]=[o("td",{colspan:"4",class:"px-3 py-4 text-center text-muted-foreground"}," No cohorts added yet. ",-1)])])):B("",!0)])])])])])]),_:1})],64))}});export{Ce as default};
