import{d as A,q as X,u as e,K as J,w as n,J as ee,o as x,ak as te,c as $,a as l,b as u,e as d,ah as ae,y as le,p as re,t as C,f as N,g as R,x as P,G as B,s as K,j as z,h as oe,k as H}from"./app-V76evz6G.js";import{_ as se}from"./AvatarUpload.vue_vue_type_script_setup_true_lang-CncnTl4F.js";import{q as D}from"./index-ueziRkVZ.js";import{a as W,_ as ne}from"./Layout.vue_vue_type_script_setup_true_lang-CV8jDZ1m.js";import{_ as v}from"./InputError.vue_vue_type_script_setup_true_lang-Cdtc9KKX.js";import{_ as S}from"./FlashMessages.vue_vue_type_script_setup_true_lang-CRIGBRWp.js";import{w as ue,a as de,b as ie,c as me,d as pe,B as fe,_ as ce,A as ge}from"./UserMenuContent.vue_vue_type_script_setup_true_lang-Dr8b2uXp.js";import{_ as _e}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-BcHZNhj3.js";import{_ as f}from"./Input.vue_vue_type_script_setup_true_lang-TncQ48jP.js";import{_ as p}from"./Label.vue_vue_type_script_setup_true_lang-CcVdSWIv.js";import{_ as O}from"./LoadingButton.vue_vue_type_script_setup_true_lang-M8VMKyGl.js";import{_ as ye}from"./AppLayout.vue_vue_type_script_setup_true_lang-BCmUAUV4.js";import"./createLucideIcon-D8DlfC-D.js";import"./index-hQ9SfOkF.js";import"./index-DZmBbJgz.js";import"./useForwardPropsEmits-Do_0Ola4.js";import"./RovingFocusGroup-C17lhl7u.js";import"./useForwardExpose-FvI28VS4.js";import"./index-Sn8BDqwf.js";import"./Spinner.vue_vue_type_script_setup_true_lang-urkv2zGr.js";import"./VisuallyHidden-DoVP1t1k.js";const ve=A({__name:"DialogClose",props:{asChild:{type:Boolean},as:{}},setup(t){const b=t;return(c,o)=>(x(),X(e(ue),J({"data-slot":"dialog-close"},b),{default:n(()=>[ee(c.$slots,"default")]),_:3},16))}}),g=t=>({url:g.url(t),method:"get"});g.definition={methods:["get","head"],url:"/settings/profile"};g.url=t=>g.definition.url+D(t);g.get=t=>({url:g.url(t),method:"get"});g.head=t=>({url:g.url(t),method:"head"});const F=t=>({action:g.url(t),method:"get"});F.get=t=>({action:g.url(t),method:"get"});F.head=t=>({action:g.url({[t?.mergeQuery?"mergeQuery":"query"]:{_method:"HEAD",...t?.query??t?.mergeQuery??{}}}),method:"get"});g.form=F;const _=t=>({url:_.url(t),method:"patch"});_.definition={methods:["patch","put"],url:"/settings/profile"};_.url=t=>_.definition.url+D(t);_.patch=t=>({url:_.url(t),method:"patch"});_.put=t=>({url:_.url(t),method:"put"});const I=t=>({action:_.url({[t?.mergeQuery?"mergeQuery":"query"]:{_method:"PATCH",...t?.query??t?.mergeQuery??{}}}),method:"post"});I.patch=t=>({action:_.url({[t?.mergeQuery?"mergeQuery":"query"]:{_method:"PATCH",...t?.query??t?.mergeQuery??{}}}),method:"post"});I.put=t=>({action:_.url({[t?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...t?.query??t?.mergeQuery??{}}}),method:"post"});_.form=I;const w=t=>({url:w.url(t),method:"put"});w.definition={methods:["put"],url:"/settings/avatar"};w.url=t=>w.definition.url+D(t);w.put=t=>({url:w.url(t),method:"put"});const M=t=>({action:w.url({[t?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...t?.query??t?.mergeQuery??{}}}),method:"post"});M.put=t=>({action:w.url({[t?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...t?.query??t?.mergeQuery??{}}}),method:"post"});w.form=M;const U=t=>({url:U.url(t),method:"delete"});U.definition={methods:["delete"],url:"/settings/profile"};U.url=t=>U.definition.url+D(t);U.delete=t=>({url:U.url(t),method:"delete"});const G=t=>({action:U.url({[t?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...t?.query??t?.mergeQuery??{}}}),method:"post"});G.delete=t=>({action:U.url({[t?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...t?.query??t?.mergeQuery??{}}}),method:"post"});U.form=G;const be={edit:g,update:_,updateAvatar:w,destroy:U},Ve={class:"space-y-6"},he={class:"space-y-4 rounded-lg border border-red-100 bg-red-50 p-4 dark:border-red-200/10 dark:bg-red-700/10"},xe={class:"grid gap-2"},ke=A({__name:"DeleteUser",setup(t){const b=te("passwordInput");return(c,o)=>(x(),$("div",Ve,[l(W,{variant:"small",title:"Delete account",description:"Delete your account and all of its resources"}),u("div",he,[o[7]||(o[7]=u("div",{class:"relative space-y-0.5 text-red-600 dark:text-red-100"},[u("p",{class:"font-medium"},"Warning"),u("p",{class:"text-sm"}," Please proceed with caution, this cannot be undone. ")],-1)),l(e(ce),null,{default:n(()=>[l(e(_e),{"as-child":""},{default:n(()=>[l(e(S),{variant:"destructive","data-test":"delete-user-button"},{default:n(()=>[...o[1]||(o[1]=[d("Delete account",-1)])]),_:1})]),_:1}),l(e(de),null,{default:n(()=>[l(e(ae),J(e(be).destroy.form(),{"reset-on-success":"",onError:o[0]||(o[0]=()=>b.value?.$el?.focus()),options:{preserveScroll:!0},class:"space-y-6"}),{default:n(({errors:r,processing:i,reset:y,clearErrors:q})=>[l(e(ie),{class:"space-y-3"},{default:n(()=>[l(e(me),null,{default:n(()=>[...o[2]||(o[2]=[d("Are you sure you want to delete your account?",-1)])]),_:1}),l(e(pe),null,{default:n(()=>[...o[3]||(o[3]=[d(" Once your account is deleted, all of its resources and data will also be permanently deleted. Please enter your password to confirm you would like to permanently delete your account. ",-1)])]),_:1})]),_:1}),u("div",xe,[l(e(p),{for:"password",class:"sr-only"},{default:n(()=>[...o[4]||(o[4]=[d("Password",-1)])]),_:1}),l(e(f),{id:"password",type:"password",name:"password",ref_key:"passwordInput",ref:b,placeholder:"Password"},null,512),l(v,{message:r.password},null,8,["message"])]),l(e(fe),{class:"gap-2"},{default:n(()=>[l(e(ve),{"as-child":""},{default:n(()=>[l(e(S),{variant:"secondary",onClick:()=>{q(),y()}},{default:n(()=>[...o[5]||(o[5]=[d(" Cancel ",-1)])]),_:1},8,["onClick"])]),_:2},1024),l(e(S),{type:"submit",variant:"destructive",disabled:i,"data-test":"confirm-delete-user-button"},{default:n(()=>[...o[6]||(o[6]=[d(" Delete account ",-1)])]),_:1},8,["disabled"])]),_:2},1024)]),_:1},16)]),_:1})]),_:1})])]))}}),we={class:"grid gap-2"},Ue={class:"relative"},$e={key:0,class:"text-xs text-muted-foreground"},qe={key:0,class:"text-destructive"},Qe={key:1},Pe={key:2,class:"text-green-600"},Ce={key:3,class:"text-destructive"},Ae=A({__name:"UsernameInput",props:{modelValue:{},name:{default:"username"},disabled:{type:Boolean,default:!1},checkAvailability:{type:Boolean,default:!0}},emits:["update:modelValue","availability"],setup(t,{emit:b}){const c=t,o=b,r=B(),i=R(!1),y=R(null),q=/^[a-z0-9_]+$/;let V=0,k=null;const Q=P(()=>r.props.errors?.[c.name]??null),a=m=>m.replace(/^@+/,"").toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"").replace(/_+/g,"_").replace(/^_+|_+$/g,"").slice(0,30),s=m=>m===""?null:m.length<3?"Username must be at least 3 characters.":q.test(m)?null:"Username may only contain lowercase letters, numbers, and underscores.",L=P(()=>s(c.modelValue)),T=()=>{y.value=null,o("availability",null)},Y=async m=>{if(!c.checkAvailability)return;if(s(m)!==null){i.value=!1,T();return}const h=++V;i.value=!0;try{const E=await fetch("/api/check-username",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")??""},body:JSON.stringify({username:m})});if(h!==V)return;if(!E.ok){T();return}const j=await E.json();y.value=typeof j.data?.available=="boolean"?j.data.available:null,o("availability",y.value)}catch{if(h!==V)return;T()}finally{h===V&&(i.value=!1)}};le(()=>c.modelValue,m=>{k!==null&&clearTimeout(k);const h=a(m);if(h!==m){o("update:modelValue",h);return}V++,i.value=!1,T(),k=setTimeout(()=>{Y(m)},400)}),re(()=>{k!==null&&clearTimeout(k)});const Z=m=>{o("update:modelValue",a(m))};return(m,h)=>(x(),$("div",we,[u("div",Ue,[h[1]||(h[1]=u("span",{class:"absolute top-1/2 left-3 -translate-y-1/2 text-muted-foreground"},"@",-1)),l(e(f),{name:t.name,disabled:t.disabled,"model-value":t.modelValue,class:"pl-7",placeholder:"username","onUpdate:modelValue":h[0]||(h[0]=E=>Z(E))},null,8,["name","disabled","model-value"])]),t.checkAvailability?(x(),$("div",$e,[L.value?(x(),$("span",qe,C(L.value),1)):i.value?(x(),$("span",Qe,"Checking availability...")):y.value===!0?(x(),$("span",Pe,"Username is available.")):y.value===!1?(x(),$("span",Ce,"Username is not available.")):N("",!0)])):N("",!0),l(v,{message:Q.value},null,8,["message"])]))}}),Te={class:"grid gap-2"},Ee=["name","rows","value","placeholder"],De=A({__name:"WordCountTextarea",props:{modelValue:{},name:{default:"bio"},maxWords:{default:100},rows:{default:4},placeholder:{default:""}},emits:["update:modelValue"],setup(t,{emit:b}){const c=t,o=b,r=B(),i=P(()=>{const V=c.modelValue.trim();return V===""?0:V.split(/\s+/).length}),y=P(()=>i.value>c.maxWords?"text-destructive":i.value>=c.maxWords-10?"text-amber-600":"text-muted-foreground"),q=P(()=>r.props.errors?.[c.name]??null);return(V,k)=>(x(),$("div",Te,[u("textarea",{name:t.name,rows:t.rows,value:t.modelValue,placeholder:t.placeholder,class:"flex min-h-24 w-full rounded-md border border-input bg-background px-3 py-2 text-sm shadow-xs outline-none ring-ring/50 transition-[color,box-shadow] placeholder:text-muted-foreground focus-visible:ring-[3px]",onInput:k[0]||(k[0]=Q=>o("update:modelValue",Q.target.value))},null,40,Ee),u("div",{class:K(["text-right text-xs",y.value])},C(i.value)+" / "+C(t.maxWords)+" words ",3),l(v,{message:q.value},null,8,["message"])]))}}),Se={class:"space-y-6"},Ne={class:"grid gap-2"},We={class:"grid gap-2"},Be={class:"grid gap-2"},Fe={key:0,class:"text-xs text-muted-foreground"},Ie={class:"grid gap-4 md:grid-cols-2"},Le={class:"grid gap-2"},je={class:"grid gap-2"},Re={class:"grid gap-2 md:col-span-2"},ze={class:"flex items-center justify-between"},He={class:"grid gap-2"},Oe={class:"grid gap-2"},Xe={class:"grid gap-2"},Je={class:"grid gap-4 md:grid-cols-2"},Ke={class:"grid gap-2"},Me={class:"grid gap-2"},Ge={class:"grid gap-2"},Ye={class:"grid gap-2"},Ze={class:"grid gap-2"},et={class:"space-y-4"},xt=A({__name:"Profile",props:{canUpdateUsernameAt:{}},setup(t){const b=t,o=B().props.auth.user,r=z({name:o?.name??"",nickname:o?.nickname??"",email:o?.email??"",username:o?.username??"",bio:o?.bio??"",profession:o?.profession??"",quote:o?.quote??"",location:o?.location??"",phone:o?.phone??"",facebook_username:o?.facebook_username??"",x_username:o?.x_username??"",tiktok_username:o?.tiktok_username??"",instagram_username:o?.instagram_username??"",website:o?.website??"",email_public:o?.email_public??""}),i=z({avatar:null}),y=P(()=>{const Q=r.quote.trim();return Q===""?0:Q.split(/\s+/).filter(a=>a!=="").length}),q=P(()=>y.value>8),V=()=>{if(q.value){r.setError("quote","Quote may not exceed 8 words.");return}r.clearErrors("quote"),r.put("/settings/profile")},k=()=>{i.put("/settings/avatar",{forceFormData:!0})};return(Q,a)=>(x(),X(ye,{breadcrumbs:[{title:"Profile settings",href:e(ge)().url}]},{default:n(()=>[l(e(oe),{title:"Profile settings"}),l(ne,null,{default:n(()=>[u("div",Se,[l(W,{variant:"small",title:"Profile information",description:"Update your public and account profile details."}),u("form",{class:"space-y-6",onSubmit:H(V,["prevent"])},[u("div",Ne,[l(e(p),{for:"name"},{default:n(()=>[...a[17]||(a[17]=[d("Name",-1)])]),_:1}),l(e(f),{id:"name",modelValue:e(r).name,"onUpdate:modelValue":a[0]||(a[0]=s=>e(r).name=s),placeholder:"e.g. Jane Doe"},null,8,["modelValue"]),l(v,{message:e(r).errors.name},null,8,["message"])]),u("div",We,[l(e(p),{for:"email"},{default:n(()=>[...a[18]||(a[18]=[d("Email",-1)])]),_:1}),l(e(f),{id:"email",type:"email",modelValue:e(r).email,"onUpdate:modelValue":a[1]||(a[1]=s=>e(r).email=s),placeholder:"you@example.com"},null,8,["modelValue"]),l(v,{message:e(r).errors.email},null,8,["message"])]),u("div",Be,[l(e(p),null,{default:n(()=>[...a[19]||(a[19]=[d("Username",-1)])]),_:1}),l(Ae,{modelValue:e(r).username,"onUpdate:modelValue":a[2]||(a[2]=s=>e(r).username=s)},null,8,["modelValue"]),b.canUpdateUsernameAt?(x(),$("p",Fe," Next change available on "+C(new Date(b.canUpdateUsernameAt).toLocaleDateString()),1)):N("",!0)]),l(De,{modelValue:e(r).bio,"onUpdate:modelValue":a[3]||(a[3]=s=>e(r).bio=s),name:"bio",placeholder:"Tell your class about yourself"},null,8,["modelValue"]),u("div",Ie,[u("div",Le,[l(e(p),{for:"nickname"},{default:n(()=>[...a[20]||(a[20]=[d("Nickname",-1)])]),_:1}),l(e(f),{id:"nickname",modelValue:e(r).nickname,"onUpdate:modelValue":a[4]||(a[4]=s=>e(r).nickname=s),maxlength:"80",placeholder:'e.g. "The Visionary"'},null,8,["modelValue"]),l(v,{message:e(r).errors.nickname},null,8,["message"])]),u("div",je,[l(e(p),{for:"profession"},{default:n(()=>[...a[21]||(a[21]=[d("Profession",-1)])]),_:1}),l(e(f),{id:"profession",modelValue:e(r).profession,"onUpdate:modelValue":a[5]||(a[5]=s=>e(r).profession=s),placeholder:"e.g. Photographer"},null,8,["modelValue"]),l(v,{message:e(r).errors.profession},null,8,["message"])]),u("div",Re,[l(e(p),{for:"quote"},{default:n(()=>[...a[22]||(a[22]=[d("Short Quote (max 8 words)",-1)])]),_:1}),l(e(f),{id:"quote",modelValue:e(r).quote,"onUpdate:modelValue":a[6]||(a[6]=s=>e(r).quote=s),maxlength:"120",placeholder:"e.g. Rise, build, and leave impact.",onInput:a[7]||(a[7]=s=>e(r).clearErrors("quote"))},null,8,["modelValue"]),u("div",ze,[l(v,{message:e(r).errors.quote},null,8,["message"]),u("p",{class:K(["text-xs",q.value?"text-destructive":"text-muted-foreground"])},C(y.value)+"/8 words ",3)])]),u("div",He,[l(e(p),{for:"location"},{default:n(()=>[...a[23]||(a[23]=[d("Location",-1)])]),_:1}),l(e(f),{id:"location",modelValue:e(r).location,"onUpdate:modelValue":a[8]||(a[8]=s=>e(r).location=s),placeholder:"e.g. Lagos, Nigeria"},null,8,["modelValue"]),l(v,{message:e(r).errors.location},null,8,["message"])])]),u("div",Oe,[l(e(p),{for:"phone"},{default:n(()=>[...a[24]||(a[24]=[d("WhatsApp Number",-1)])]),_:1}),l(e(f),{id:"phone",modelValue:e(r).phone,"onUpdate:modelValue":a[9]||(a[9]=s=>e(r).phone=s),placeholder:"+1 555 123 4567"},null,8,["modelValue"]),l(v,{message:e(r).errors.phone},null,8,["message"])]),u("div",Xe,[l(e(p),{for:"website"},{default:n(()=>[...a[25]||(a[25]=[d("Website (without https://)",-1)])]),_:1}),l(e(f),{id:"website",modelValue:e(r).website,"onUpdate:modelValue":a[10]||(a[10]=s=>e(r).website=s),placeholder:"example.com"},null,8,["modelValue"]),l(v,{message:e(r).errors.website},null,8,["message"])]),u("div",Je,[u("div",Ke,[l(e(p),{for:"facebook_username"},{default:n(()=>[...a[26]||(a[26]=[d("Facebook",-1)])]),_:1}),l(e(f),{id:"facebook_username",modelValue:e(r).facebook_username,"onUpdate:modelValue":a[11]||(a[11]=s=>e(r).facebook_username=s),placeholder:"facebook_username"},null,8,["modelValue"])]),u("div",Me,[l(e(p),{for:"x_username"},{default:n(()=>[...a[27]||(a[27]=[d("X",-1)])]),_:1}),l(e(f),{id:"x_username",modelValue:e(r).x_username,"onUpdate:modelValue":a[12]||(a[12]=s=>e(r).x_username=s),placeholder:"x_username"},null,8,["modelValue"])]),u("div",Ge,[l(e(p),{for:"tiktok_username"},{default:n(()=>[...a[28]||(a[28]=[d("TikTok",-1)])]),_:1}),l(e(f),{id:"tiktok_username",modelValue:e(r).tiktok_username,"onUpdate:modelValue":a[13]||(a[13]=s=>e(r).tiktok_username=s),placeholder:"tiktok_username"},null,8,["modelValue"])]),u("div",Ye,[l(e(p),{for:"instagram_username"},{default:n(()=>[...a[29]||(a[29]=[d("Instagram",-1)])]),_:1}),l(e(f),{id:"instagram_username",modelValue:e(r).instagram_username,"onUpdate:modelValue":a[14]||(a[14]=s=>e(r).instagram_username=s),placeholder:"instagram_username"},null,8,["modelValue"])])]),u("div",Ze,[l(e(p),{for:"email_public"},{default:n(()=>[...a[30]||(a[30]=[d("Public Email",-1)])]),_:1}),l(e(f),{id:"email_public",type:"email",modelValue:e(r).email_public,"onUpdate:modelValue":a[15]||(a[15]=s=>e(r).email_public=s),placeholder:"public-contact@example.com"},null,8,["modelValue"]),l(v,{message:e(r).errors.email_public},null,8,["message"])]),l(O,{type:"submit",loading:e(r).processing,"loading-text":"Saving..."},{default:n(()=>[...a[31]||(a[31]=[d(" Save Profile ",-1)])]),_:1},8,["loading"])],32)]),u("div",et,[l(W,{variant:"small",title:"Avatar",description:"Upload and replace your profile picture."}),u("form",{class:"space-y-4",onSubmit:H(k,["prevent"])},[l(se,{modelValue:e(i).avatar,"onUpdate:modelValue":a[16]||(a[16]=s=>e(i).avatar=s),"current-avatar":e(o)?.avatar??null},null,8,["modelValue","current-avatar"]),l(O,{type:"submit",loading:e(i).processing,"loading-text":"Uploading..."},{default:n(()=>[...a[32]||(a[32]=[d(" Update Avatar ",-1)])]),_:1},8,["loading"])],32)]),l(ke)]),_:1})]),_:1},8,["breadcrumbs"]))}});export{xt as default};
