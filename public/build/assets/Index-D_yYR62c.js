import{_ as R,a as T}from"./UsernameInput.vue_vue_type_script_setup_true_lang-BavDwKKL.js";import{_}from"./InputError.vue_vue_type_script_setup_true_lang-BltmWT9M.js";import{_ as S}from"./LoadingButton.vue_vue_type_script_setup_true_lang-B7F_b-eQ.js";import{_ as P}from"./Input.vue_vue_type_script_setup_true_lang--CnlkcD7.js";import{_ as G}from"./Label.vue_vue_type_script_setup_true_lang-_4_XZR1r.js";import{_ as H}from"./AppLayout.vue_vue_type_script_setup_true_lang-CPtdiE_o.js";import{d as J,g as p,j as K,q as M,c as n,a as i,u as l,h as Q,w as f,b as o,t as m,o as u,F as y,r as x,y as C,e as h,f as v,p as L,D as W,x as k,i as Y}from"./app-DW2KkjvG.js";import"./FlashMessages.vue_vue_type_script_setup_true_lang-DzlBP8Dr.js";import"./createLucideIcon-DK4FZEuV.js";import"./Spinner.vue_vue_type_script_setup_true_lang-Bs6myhA4.js";import"./index-DDc9h_z2.js";import"./index-BafghysU.js";import"./useForwardExpose-Bu8G4Clg.js";import"./RovingFocusGroup-DlkB2bT6.js";import"./UserMenuContent.vue_vue_type_script_setup_true_lang-CGOEXzev.js";import"./useForwardPropsEmits-Dt7zh49w.js";import"./index-ueziRkVZ.js";import"./VisuallyHidden-BooNPzSY.js";const X={class:"mx-auto w-full max-w-3xl space-y-6 p-4"},Z={class:"space-y-2"},ee={class:"text-sm text-muted-foreground"},re={class:"grid grid-cols-5 gap-2"},se={key:0,class:"space-y-4 rounded-xl border border-border bg-card p-4"},te={class:"grid gap-3 md:grid-cols-2"},oe=["onClick"],le={class:"font-semibold"},ae={class:"text-sm text-muted-foreground"},ue={key:1,class:"space-y-4 rounded-xl border border-border bg-card p-4"},ne={class:"grid gap-3 md:grid-cols-2"},ie=["onClick"],de={class:"font-semibold"},ce={class:"text-sm text-muted-foreground"},me={key:2,class:"space-y-4 rounded-xl border border-border bg-card p-4"},_e={key:0,class:"space-y-3"},ve={class:"grid gap-3 md:grid-cols-2"},pe=["onClick"],fe={class:"font-semibold"},ye={class:"text-xs text-muted-foreground"},ge={key:1,class:"text-sm text-muted-foreground"},be={key:3,class:"space-y-4 rounded-xl border border-border bg-card p-4"},xe={key:4,class:"space-y-4 rounded-xl border border-border bg-card p-4"},Ce={class:"flex items-center justify-between"},Ee=J({__name:"Index",props:{universities:{},courses:{},courseYears:{},selectedUniversityId:{},selectedCourseId:{},selectedCourseYearId:{},search:{}},setup(V){const c=V,F=W(),a=p(1),g=p(c.search??""),b=p(""),$=p(null),t=p({university_id:null,course_id:null,course_year_id:null,username:null}),s=K({university_id:c.selectedUniversityId,course_id:c.selectedCourseId,course_year_id:c.selectedCourseYearId,username:F.props.auth.user?.username??"",avatar:null}),B=k(()=>g.value.trim()===""?c.universities:c.universities.filter(d=>d.name.toLowerCase().includes(g.value.toLowerCase()))),N=k(()=>{if(b.value.trim()==="")return c.courses;const d=b.value.toLowerCase();return c.courses.filter(e=>`${e.name} ${e.short_name} ${e.nickname??""}`.toLowerCase().includes(d))}),z=k(()=>s.username.trim().toLowerCase()),D=/^[a-z0-9_]{3,30}$/,U=k(()=>{const d=c.courseYears.find(e=>e.id===s.course_year_id);return d===void 0?null:`Class of ${d.year}`});M(()=>s.username,()=>{t.value.username=null});const j=d=>{s.university_id=d,s.course_id=null,s.course_year_id=null,t.value.university_id=null,t.value.course_id=null,t.value.course_year_id=null,Y.get("/onboarding",{university_id:d},{preserveState:!0,preserveScroll:!0,replace:!0,only:["courses","courseYears","selectedUniversityId","selectedCourseId","selectedCourseYearId"]})},A=d=>{s.course_id=d,s.course_year_id=null,t.value.course_id=null,t.value.course_year_id=null,Y.get("/onboarding",{university_id:s.university_id,course_id:d},{preserveState:!0,preserveScroll:!0,replace:!0,only:["courseYears","selectedCourseId","selectedCourseYearId"]})},w=()=>a.value===1?s.university_id===null?(t.value.university_id="Please select a university.",!1):(t.value.university_id=null,!0):a.value===2?s.course_id===null?(t.value.course_id="Please select a course.",!1):(t.value.course_id=null,!0):a.value===3?s.course_year_id===null?(t.value.course_year_id="Please select a cohort.",!1):(t.value.course_year_id=null,!0):a.value===4?D.test(z.value)?$.value!==!0?(t.value.username="Please choose an available username before continuing.",!1):(t.value.username=null,!0):(t.value.username="Username must be 3-30 characters and contain only lowercase letters, numbers, or underscores.",!1):!0,E=()=>{w()&&a.value<5&&(a.value+=1)},O=()=>{a.value>1&&(a.value-=1)},q=()=>{w()&&s.post("/onboarding",{forceFormData:!0})};return(d,e)=>(u(),n(y,null,[i(l(Q),{title:"Onboarding"}),i(H,null,{default:f(()=>[o("div",X,[o("div",Z,[e[5]||(e[5]=o("h1",{class:"text-2xl font-semibold"},"Complete your profile",-1)),o("p",ee," Step "+m(a.value)+" of 5 ",1),o("div",re,[(u(),n(y,null,x(5,r=>o("div",{key:r,class:C(["h-1.5 rounded-full",r<=a.value?"bg-primary":"bg-muted"])},null,2)),64))])]),a.value===1?(u(),n("section",se,[i(l(G),{for:"university-search"},{default:f(()=>[...e[6]||(e[6]=[h("Select University",-1)])]),_:1}),i(l(P),{id:"university-search",modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=r=>g.value=r),placeholder:"Search university..."},null,8,["modelValue"]),o("div",te,[(u(!0),n(y,null,x(B.value,r=>(u(),n("button",{key:r.id,type:"button",class:C(["rounded-lg border p-4 text-left hover:border-primary",l(s).university_id===r.id?"border-primary":"border-border"]),onClick:I=>j(r.id)},[o("p",le,m(r.name),1),o("p",ae,m(r.location),1)],10,oe))),128))]),i(_,{message:l(s).errors.university_id},null,8,["message"]),i(_,{message:t.value.university_id},null,8,["message"])])):v("",!0),a.value===2?(u(),n("section",ue,[e[7]||(e[7]=o("h2",{class:"font-semibold"},"Select Program",-1)),i(l(P),{modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=r=>b.value=r),placeholder:"Search program..."},null,8,["modelValue"]),o("div",ne,[(u(!0),n(y,null,x(N.value,r=>(u(),n("button",{key:r.id,type:"button",class:C(["rounded-lg border p-4 text-left hover:border-primary",l(s).course_id===r.id?"border-primary":"border-border"]),onClick:I=>A(r.id)},[o("p",de,m(r.name),1),o("p",ce,m(r.short_name),1)],10,ie))),128))]),i(_,{message:l(s).errors.course_id},null,8,["message"]),i(_,{message:t.value.course_id},null,8,["message"])])):v("",!0),a.value===3?(u(),n("section",me,[e[8]||(e[8]=o("h2",{class:"font-semibold"},"Select Cohort",-1)),V.courseYears.length>0?(u(),n("div",_e,[o("div",ve,[(u(!0),n(y,null,x(V.courseYears,r=>(u(),n("button",{key:r.id,type:"button",class:C(["rounded-lg border p-4 text-left hover:border-primary",l(s).course_year_id===r.id?"border-primary":"border-border"]),onClick:I=>{l(s).course_year_id=r.id,t.value.course_year_id=null}},[o("p",fe," Class of "+m(r.year),1),o("p",ye,m(r.slug),1)],10,pe))),128))])])):v("",!0),U.value?(u(),n("p",ge," Selected: "+m(U.value),1)):v("",!0),i(_,{message:l(s).errors.course_year_id},null,8,["message"]),i(_,{message:t.value.course_year_id},null,8,["message"])])):v("",!0),a.value===4?(u(),n("section",be,[e[9]||(e[9]=o("h2",{class:"font-semibold"},"Choose Username",-1)),i(R,{modelValue:l(s).username,"onUpdate:modelValue":e[2]||(e[2]=r=>l(s).username=r),onAvailability:e[3]||(e[3]=r=>$.value=r)},null,8,["modelValue"]),i(_,{message:t.value.username},null,8,["message"])])):v("",!0),a.value===5?(u(),n("section",xe,[e[10]||(e[10]=o("h2",{class:"font-semibold"},"Upload Profile Photo (Optional)",-1)),i(T,{modelValue:l(s).avatar,"onUpdate:modelValue":e[4]||(e[4]=r=>l(s).avatar=r)},null,8,["modelValue"])])):v("",!0),o("div",Ce,[i(S,{type:"button",variant:"outline",disabled:a.value===1,loading:l(s).processing,"loading-text":"Please wait...",onClick:O},{default:f(()=>[...e[11]||(e[11]=[h(" Back ",-1)])]),_:1},8,["disabled","loading"]),a.value<5?(u(),L(S,{key:0,type:"button",loading:l(s).processing,"loading-text":"Validating...",onClick:E},{default:f(()=>[...e[12]||(e[12]=[h(" Next ",-1)])]),_:1},8,["loading"])):(u(),L(S,{key:1,loading:l(s).processing,"loading-text":"Finishing...",onClick:q},{default:f(()=>[...e[13]||(e[13]=[h(" Finish ",-1)])]),_:1},8,["loading"]))])])]),_:1})],64))}});export{Ee as default};
