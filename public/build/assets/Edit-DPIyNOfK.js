import{d as B,j as c,q as D,c as p,a as o,u as t,h as A,w as a,b as s,t as v,l as R,e as d,m as x,o as f,F as k,r as U,v as V,s as I,f as j,n as C}from"./app-Xw8PJXQX.js";import{_ as n}from"./InputError.vue_vue_type_script_setup_true_lang-LEFJ3YZP.js";import{_ as S}from"./LoadingButton.vue_vue_type_script_setup_true_lang-CFsavXG6.js";import{_ as M}from"./FlashMessages.vue_vue_type_script_setup_true_lang-Bfj-M2-J.js";import{_}from"./Input.vue_vue_type_script_setup_true_lang-Bp2HSOOx.js";import{_ as $}from"./Label.vue_vue_type_script_setup_true_lang-Do0tOrF7.js";import{_ as q}from"./AppLayout.vue_vue_type_script_setup_true_lang-D60ySLUZ.js";import"./Spinner.vue_vue_type_script_setup_true_lang-DhH_KxvP.js";import"./createLucideIcon-Dqvgc3pD.js";import"./index-CPB1U3Gd.js";import"./index-DRPMKLPy.js";import"./useForwardExpose-B_D4EoIC.js";import"./RovingFocusGroup-BAQMVA2P.js";import"./UserMenuContent.vue_vue_type_script_setup_true_lang-ghQ8lCcE.js";import"./useForwardPropsEmits-C8m6eQjK.js";import"./index-ueziRkVZ.js";import"./VisuallyHidden-Cm9f6LED.js";const L={class:"mx-auto w-full max-w-4xl space-y-4 p-4"},P={class:"flex items-center justify-between"},T={class:"mt-1 text-sm text-muted-foreground"},Y={class:"rounded-xl border border-border bg-card p-4 text-sm"},z=["href"],G={class:"rounded-xl border border-border bg-card p-4"},H={class:"grid gap-3"},J={class:"grid gap-2 md:grid-cols-2"},K={class:"grid gap-2"},O=["value"],Q={class:"grid gap-2"},W=["value"],X={class:"flex items-center gap-2 text-xs"},Z={key:0,class:"rounded-md border border-amber-500/30 bg-amber-500/10 px-3 py-2 text-xs text-amber-600 dark:text-amber-300"},h={class:"grid gap-4 md:grid-cols-2"},ee={class:"rounded-xl border border-border bg-card p-4"},se=["disabled"],te={class:"rounded-xl border border-border bg-card p-4"},re=["disabled"],ce=B({__name:"Edit",props:{user:{},currentUserId:{},universities:{},courses:{}},setup(u){const i=u,r=c({name:i.user.name,email:i.user.email,username:i.user.username,website:i.user.website??"",is_verified:!!i.user.is_verified,email_verified_at:i.user.email_verified_at?String(i.user.email_verified_at).slice(0,16):"",university_id:i.user.university_id??null,course_id:i.user.course_id??null}),b=c({status:i.user.status}),g=c({role:i.user.role}),m=C(()=>i.currentUserId===null||i.currentUserId!==i.user.id),w=C(()=>r.university_id===null?[]:i.courses.filter(y=>y.university_id===r.university_id));D(()=>r.university_id,()=>{r.course_id!==null&&!w.value.some(y=>y.id===r.course_id)&&(r.course_id=null)});const N=()=>{r.put(`/admin/users/${i.user.id}`,{preserveScroll:!0})},E=()=>{m.value&&b.put(`/admin/users/${i.user.id}/status`,{preserveScroll:!0})},F=()=>{m.value&&g.put(`/admin/users/${i.user.id}/role`,{preserveScroll:!0})};return(y,e)=>(f(),p(k,null,[o(t(A),{title:`Edit ${u.user.name}`},null,8,["title"]),o(q,null,{default:a(()=>[s("div",L,[s("div",P,[s("div",null,[e[10]||(e[10]=s("h1",{class:"text-2xl font-semibold"},"Edit User",-1)),s("p",T," @"+v(u.user.username),1)]),o(t(R),{href:"/admin/users"},{default:a(()=>[o(t(M),{variant:"outline"},{default:a(()=>[...e[11]||(e[11]=[d("Back to Users",-1)])]),_:1})]),_:1})]),s("div",Y,[s("p",null,[e[12]||(e[12]=s("span",{class:"text-muted-foreground"},"University:",-1)),d(" "+v(u.user.university?.name??"Not set"),1)]),s("p",null,[e[13]||(e[13]=s("span",{class:"text-muted-foreground"},"Course:",-1)),d(" "+v(u.user.course?.name??"Not set"),1)]),s("p",null,[e[14]||(e[14]=s("span",{class:"text-muted-foreground"},"Public profile:",-1)),s("a",{href:`/@${u.user.username}`,target:"_blank",rel:"noopener noreferrer",class:"underline underline-offset-4"}," View profile ",8,z)])]),s("div",G,[e[22]||(e[22]=s("h2",{class:"mb-3 text-base font-semibold"},"User Details",-1)),s("div",H,[s("div",null,[o(t(_),{modelValue:t(r).name,"onUpdate:modelValue":e[0]||(e[0]=l=>t(r).name=l),placeholder:"Full name"},null,8,["modelValue"]),o(n,{message:t(r).errors.name},null,8,["message"])]),s("div",null,[o(t(_),{modelValue:t(r).email,"onUpdate:modelValue":e[1]||(e[1]=l=>t(r).email=l),type:"email",placeholder:"Email"},null,8,["modelValue"]),o(n,{message:t(r).errors.email},null,8,["message"])]),s("div",null,[o(t(_),{modelValue:t(r).username,"onUpdate:modelValue":e[2]||(e[2]=l=>t(r).username=l),placeholder:"username"},null,8,["modelValue"]),o(n,{message:t(r).errors.username},null,8,["message"])]),s("div",null,[o(t(_),{modelValue:t(r).website,"onUpdate:modelValue":e[3]||(e[3]=l=>t(r).website=l),placeholder:"example.com"},null,8,["modelValue"]),o(n,{message:t(r).errors.website},null,8,["message"])]),s("div",J,[s("div",K,[o(t($),{for:"university_id"},{default:a(()=>[...e[15]||(e[15]=[d("University",-1)])]),_:1}),x(s("select",{id:"university_id","onUpdate:modelValue":e[4]||(e[4]=l=>t(r).university_id=l),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},[e[16]||(e[16]=s("option",{value:null},"Not set",-1)),(f(!0),p(k,null,U(u.universities,l=>(f(),p("option",{key:l.id,value:l.id},v(l.name),9,O))),128))],512),[[V,t(r).university_id]]),o(n,{message:t(r).errors.university_id},null,8,["message"])]),s("div",Q,[o(t($),{for:"course_id"},{default:a(()=>[...e[17]||(e[17]=[d("Course",-1)])]),_:1}),x(s("select",{id:"course_id","onUpdate:modelValue":e[5]||(e[5]=l=>t(r).course_id=l),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},[e[18]||(e[18]=s("option",{value:null},"Not set",-1)),(f(!0),p(k,null,U(w.value,l=>(f(),p("option",{key:l.id,value:l.id},v(l.short_name)+" Class of "+v(l.year),9,W))),128))],512),[[V,t(r).course_id]]),o(n,{message:t(r).errors.course_id},null,8,["message"])])]),s("label",X,[x(s("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>t(r).is_verified=l),type:"checkbox"},null,512),[[I,t(r).is_verified]]),e[19]||(e[19]=d(" Verified profile ",-1))]),s("div",null,[e[20]||(e[20]=s("label",{class:"mb-1 block text-xs font-medium text-muted-foreground"}," Email verified at ",-1)),o(t(_),{modelValue:t(r).email_verified_at,"onUpdate:modelValue":e[7]||(e[7]=l=>t(r).email_verified_at=l),type:"datetime-local"},null,8,["modelValue"]),o(n,{message:t(r).errors.email_verified_at},null,8,["message"])]),o(S,{type:"button",loading:t(r).processing,"loading-text":"Saving...",onClick:N},{default:a(()=>[...e[21]||(e[21]=[d(" Save Details ",-1)])]),_:1},8,["loading"])])]),m.value?j("",!0):(f(),p("p",Z," You cannot modify your own role or account status. ")),s("div",h,[s("div",ee,[e[25]||(e[25]=s("h2",{class:"mb-3 text-base font-semibold"},"Account Status",-1)),x(s("select",{"onUpdate:modelValue":e[8]||(e[8]=l=>t(b).status=l),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm",disabled:!m.value},[...e[23]||(e[23]=[s("option",{value:"active"},"Active",-1),s("option",{value:"suspended"},"Suspended",-1),s("option",{value:"banned"},"Banned",-1)])],8,se),[[V,t(b).status]]),o(n,{message:t(b).errors.status},null,8,["message"]),o(S,{type:"button",class:"mt-3",loading:t(b).processing,"loading-text":"Saving...",disabled:!m.value,onClick:E},{default:a(()=>[...e[24]||(e[24]=[d(" Save Status ",-1)])]),_:1},8,["loading","disabled"])]),s("div",te,[e[28]||(e[28]=s("h2",{class:"mb-3 text-base font-semibold"},"Role",-1)),x(s("select",{"onUpdate:modelValue":e[9]||(e[9]=l=>t(g).role=l),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm",disabled:!m.value},[...e[26]||(e[26]=[s("option",{value:"student"},"Student",-1),s("option",{value:"admin"},"Admin",-1),s("option",{value:"superadmin"},"Superadmin",-1)])],8,re),[[V,t(g).role]]),o(n,{message:t(g).errors.role},null,8,["message"]),o(S,{type:"button",class:"mt-3",loading:t(g).processing,"loading-text":"Saving...",disabled:!m.value,onClick:F},{default:a(()=>[...e[27]||(e[27]=[d(" Save Role ",-1)])]),_:1},8,["loading","disabled"])])])])]),_:1})],64))}});export{ce as default};
