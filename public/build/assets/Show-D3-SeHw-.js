import{a as W,b as q,c as G,_ as K}from"./DialogTitle.vue_vue_type_script_setup_true_lang-CoMOJCAU.js";import{d as X,g as k,q as H,B as O,G as Q,p as j,w as $,a as C,u as N,e as Y,t as p,b as o,c as a,f as d,n as c,o as s,y as S,h as Z,F as V,r as M,l as z}from"./app-C4RxZQeq.js";import{_ as ee}from"./ShareButton.vue_vue_type_script_setup_true_lang-Dx8gy14F.js";import{_ as te}from"./PublicLayout.vue_vue_type_script_setup_true_lang-DefDETTI.js";import"./useForwardPropsEmits-VfW6L23Z.js";import"./x-BuNzBGro.js";import"./useForwardExpose-CwMYFS2I.js";import"./index-2UITHzBk.js";import"./Presence-C6NHUOAT.js";import"./createLucideIcon-CIIjH0AZ.js";import"./index-CQCdNE30.js";import"./BottomNav.vue_vue_type_script_setup_true_lang-DN7C7JYV.js";const oe={class:"space-y-4"},le=["src"],se={key:0,class:"space-y-1 text-sm text-muted-foreground"},ne={key:0},ae={key:1},re={class:"space-y-1 text-center"},ie={class:"text-xs text-muted-foreground"},ue={key:0,class:"text-xs text-muted-foreground"},F=X({__name:"PhotoCarousel",props:{modelValue:{type:Boolean},photos:{},initialIndex:{default:0},title:{default:"Photo"},description:{default:null}},emits:["update:modelValue"],setup(r,{emit:t}){const m=r,y=t,h=k(m.initialIndex),x=k(null);H(()=>m.initialIndex,l=>{h.value=l});const b=c(()=>m.photos.map(l=>typeof l=="string"?{url:l,description:m.description??null,postedDiff:null,postedAt:null,downloadName:null}:{url:l.full??l.url??l.thumb??"",description:l.description??m.description??null,postedDiff:l.postedDiff??null,postedAt:l.postedAt??null,downloadName:l.downloadName??null})),u=c(()=>b.value[h.value]??null),_=c(()=>b.value.length>1),D=()=>{_.value&&(h.value=(h.value-1+b.value.length)%b.value.length)},B=()=>{_.value&&(h.value=(h.value+1)%b.value.length)},L=l=>{!m.modelValue||!_.value||(l.key==="ArrowLeft"&&D(),l.key==="ArrowRight"&&B())},T=l=>{_.value&&(x.value=l.touches[0]?.clientX??null)},A=l=>{if(!_.value||x.value===null)return;const v=l.changedTouches[0]?.clientX;if(typeof v!="number"){x.value=null;return}const g=v-x.value;Math.abs(g)>=40&&(g>0?D():B()),x.value=null},E=l=>{try{const w=new URL(l,window.location.origin).pathname.split("/").pop()??"";return w!==""?w:"photo.webp"}catch{return"photo.webp"}},U=async()=>{if(!u.value||u.value.url==="")return;const l=u.value.url,v=u.value.downloadName??E(l);try{const g=await fetch(l);if(!g.ok)throw new Error("Unable to download image");const w=await g.blob(),I=window.URL.createObjectURL(w),e=document.createElement("a");e.href=I,e.download=v,document.body.appendChild(e),e.click(),e.remove(),window.URL.revokeObjectURL(I)}catch{window.open(l,"_blank","noopener,noreferrer")}};return O(()=>{window.addEventListener("keydown",L)}),Q(()=>{window.removeEventListener("keydown",L)}),(l,v)=>(s(),j(N(K),{open:r.modelValue,"onUpdate:open":v[0]||(v[0]=g=>y("update:modelValue",g))},{default:$(()=>[C(N(W),{class:"scrollbar-hide max-h-[94vh] w-[min(95vw,72rem)] overflow-y-auto"},{default:$(()=>[C(N(q),null,{default:$(()=>[C(N(G),null,{default:$(()=>[Y(p(r.title),1)]),_:1})]),_:1}),o("div",oe,[o("div",{class:"overflow-hidden rounded-lg",onTouchstartPassive:T,onTouchendPassive:A},[u.value?.url?(s(),a("img",{key:0,src:u.value.url,alt:"Photo",class:"max-h-[72vh] w-full select-none object-contain",loading:"eager",draggable:"false"},null,8,le)):d("",!0)],32),u.value?.description||u.value?.postedDiff?(s(),a("div",se,[u.value?.description?(s(),a("p",ne,p(u.value.description),1)):d("",!0),u.value?.postedDiff?(s(),a("p",ae," Posted "+p(u.value.postedDiff),1)):d("",!0)])):d("",!0),o("div",{class:"flex items-center justify-center"},[o("button",{type:"button",class:"rounded-md border px-4 py-1.5 text-sm hover:bg-accent",onClick:U}," Download ")]),o("div",re,[o("p",ie,p(h.value+1)+" / "+p(b.value.length),1),_.value?(s(),a("p",ue," Swipe left or right to browse photos. ")):d("",!0)])])]),_:1})]),_:1},8,["open"]))}}),ce=X({__name:"VerifiedBadgeIcon",props:{class:{}},setup(r){const t=r;return(m,y)=>(s(),a("svg",{viewBox:"0 0 24 24","aria-hidden":"true",class:S(t.class)},[...y[0]||(y[0]=[o("circle",{cx:"12",cy:"12",r:"10",fill:"currentColor"},null,-1),o("path",{d:"M8 12.5 10.7 15 16 9.5",fill:"none",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},null,-1)])],2))}}),de={class:"mx-auto mt-6 w-[90%]"},fe={class:"flex flex-col gap-7 lg:flex-row lg:items-start lg:gap-10"},pe={class:"mx-auto w-full max-w-sm lg:mx-0 lg:w-72 lg:max-w-none"},me=["src","alt"],he={key:1,class:"flex h-full w-full items-center justify-center text-5xl font-semibold text-muted-foreground"},ve={class:"flex-1"},ge={class:"text-center lg:text-left"},be={class:"inline-flex items-center gap-2"},ye={class:"text-3xl font-semibold sm:text-4xl"},xe={class:"mt-1 text-base text-muted-foreground"},_e={key:0,class:"my-5 h-px bg-border"},we={key:1,class:"space-y-3 text-base text-muted-foreground"},ke={key:0,class:"h-px bg-border"},$e=["src","alt"],Ce={key:3,class:"flex items-center gap-2"},Ne={key:4,class:"flex items-center gap-2"},Ue={key:5,class:"flex items-start gap-2 leading-relaxed"},De={key:2,class:"mt-5 h-px bg-border"},Pe={key:3,class:"mt-5"},Ve={class:"grid grid-cols-4 gap-3 lg:flex lg:flex-nowrap lg:justify-start lg:gap-4"},je=["href","aria-label"],Be={class:"mt-8 border-t border-border pt-8 pb-10"},Le={class:"grid grid-cols-2 gap-3 md:grid-cols-3 lg:grid-cols-4"},Ie=["onClick"],Te=["src"],Ae={key:0,class:"rounded-xl border border-dashed border-border p-6 text-center text-sm text-muted-foreground"},Ke=X({__name:"Show",props:{profile:{},posts:{}},setup(r){const t=r,m=k(!1),y=k(!1),h=k([]),x=k(0),b=k(""),u=c(()=>t.profile.media?.[0]?.conversions?.full??t.profile.media?.[0]?.original_url??null),_=c(()=>t.profile.name.trim().charAt(0).toUpperCase()||"U"),D=c(()=>!t.profile.course?.short_name||!t.profile.course?.year?null:`${t.profile.course.short_name.toUpperCase()} Class of ${t.profile.course.year}`),B=c(()=>!!(t.profile.university?.name&&t.profile.university?.slug)),L=c(()=>!!(t.profile.course?.slug&&D.value)),T=c(()=>!!t.profile.location),A=c(()=>!!v.value),E=c(()=>!!t.profile.bio),U=c(()=>{const e=[];return B.value&&e.push("university"),L.value&&e.push("course"),T.value&&e.push("location"),A.value&&e.push("joined"),E.value&&e.push("bio"),e}),l=c(()=>{const e=[];return t.profile.phone&&e.push({key:"whatsapp",href:`https://wa.me/${t.profile.phone}`,iconClass:"fa-brands fa-whatsapp",label:"WhatsApp"}),t.profile.instagram_username&&e.push({key:"instagram",href:`https://instagram.com/${t.profile.instagram_username}`,iconClass:"fa-brands fa-instagram",label:"Instagram"}),t.profile.tiktok_username&&e.push({key:"tiktok",href:`https://tiktok.com/@${t.profile.tiktok_username}`,iconClass:"fa-brands fa-tiktok",label:"TikTok"}),t.profile.x_username&&e.push({key:"x",href:`https://x.com/${t.profile.x_username.replace(/^@/,"")}`,iconClass:"fa-brands fa-x-twitter",label:"X"}),t.profile.facebook_username&&e.push({key:"facebook",href:`https://facebook.com/${t.profile.facebook_username}`,iconClass:"fa-brands fa-facebook",label:"Facebook"}),t.profile.email_public&&e.push({key:"email",href:`mailto:${t.profile.email_public}`,iconClass:"fa-solid fa-envelope",label:"Email"}),t.profile.website&&e.push({key:"website",href:`https://${t.profile.website}`,iconClass:"fa-solid fa-globe",label:"Website"}),e}),v=c(()=>{if(!t.profile.created_at)return null;const e=new Date(t.profile.created_at);return Number.isNaN(e.getTime())?null:e.toLocaleDateString(void 0,{year:"numeric",month:"long"})}),g=e=>{if(e===null||e==="")return null;const i=new Date(e);if(Number.isNaN(i.getTime()))return null;const n=Date.now(),f=Math.round((i.getTime()-n)/1e3),P=new Intl.RelativeTimeFormat(void 0,{numeric:"auto"}),J=[{unit:"year",seconds:31536e3},{unit:"month",seconds:2592e3},{unit:"week",seconds:604800},{unit:"day",seconds:86400},{unit:"hour",seconds:3600},{unit:"minute",seconds:60}];for(const R of J)if(Math.abs(f)>=R.seconds)return P.format(Math.round(f/R.seconds),R.unit);return P.format(f,"second")},w=c(()=>t.posts.data.flatMap(e=>{const i=e.published_at??e.created_at,n=g(i);return(e.media??[]).map((f,P)=>({id:`${e.id}-${P}`,thumb:f.conversions?.thumb??f.conversions?.full??f.original_url??"",full:f.conversions?.full??f.conversions?.thumb??f.original_url??"",description:e.body,postedDiff:n,postedAt:i,downloadName:`@${t.profile.username}-photo-${e.id}-${P+1}.webp`}))})),I=e=>{h.value=w.value.filter(n=>n.full!=="");const i=h.value.findIndex(n=>n.full===e);x.value=i>=0?i:0,m.value=!0};return O(()=>{b.value=window.location.href}),(e,i)=>(s(),a(V,null,[C(N(Z),{title:`${r.profile.name} | ${e.$page.props.appName}`},null,8,["title"]),C(te,null,{default:$(()=>[o("section",de,[o("div",fe,[o("div",pe,[o("button",{type:"button",class:"h-72 w-full overflow-hidden rounded-3xl border border-border bg-muted sm:h-80 lg:h-96",onClick:i[0]||(i[0]=n=>y.value=!0)},[u.value?(s(),a("img",{key:0,src:u.value,alt:r.profile.name,class:"h-full w-full object-cover",loading:"lazy"},null,8,me)):(s(),a("div",he,p(_.value),1))])]),o("div",ve,[o("div",ge,[o("div",be,[o("h1",ye,p(r.profile.name),1),r.profile.is_verified?(s(),j(ce,{key:0,class:"size-5 shrink-0 text-primary"})):d("",!0)]),o("p",xe," @"+p(r.profile.username),1)]),U.value.length>0||l.value.length>0?(s(),a("div",_e)):d("",!0),U.value.length>0?(s(),a("div",we,[(s(!0),a(V,null,M(U.value,(n,f)=>(s(),a(V,{key:n},[f>0?(s(),a("div",ke)):d("",!0),n==="university"?(s(),j(N(z),{key:1,href:`/universities/${r.profile.university?.slug}`,class:"flex items-center gap-2 hover:text-foreground"},{default:$(()=>[r.profile.university?.media?.[0]?.conversions?.thumb||r.profile.university?.media?.[0]?.original_url?(s(),a("img",{key:0,src:r.profile.university?.media?.[0]?.conversions?.full??r.profile.university?.media?.[0]?.conversions?.thumb??r.profile.university?.media?.[0]?.original_url??"",alt:r.profile.university?.name??"University logo",class:"h-4 w-4 object-cover"},null,8,$e)):d("",!0),o("span",null,p(r.profile.university?.name),1)]),_:1},8,["href"])):n==="course"?(s(),j(N(z),{key:2,href:`/courses/${r.profile.course?.slug}`,class:"flex items-center gap-2 hover:text-foreground"},{default:$(()=>[i[3]||(i[3]=o("i",{class:"fa-solid fa-graduation-cap"},null,-1)),o("span",null,p(D.value),1)]),_:1},8,["href"])):n==="location"?(s(),a("p",Ce,[i[4]||(i[4]=o("i",{class:"fa-solid fa-location-dot"},null,-1)),o("span",null,p(r.profile.location),1)])):n==="joined"?(s(),a("p",Ne,[i[5]||(i[5]=o("i",{class:"fa-regular fa-calendar"},null,-1)),o("span",null,"Joined "+p(v.value),1)])):(s(),a("p",Ue,[i[6]||(i[6]=o("i",{class:"fa-regular fa-note-sticky pt-0.5"},null,-1)),o("span",null,p(r.profile.bio),1)]))],64))),128))])):d("",!0),l.value.length>0&&U.value.length>0?(s(),a("div",De)):d("",!0),l.value.length>0?(s(),a("div",Pe,[o("div",Ve,[(s(!0),a(V,null,M(l.value,n=>(s(),a("a",{key:n.key,href:n.href,target:"_blank",rel:"noopener noreferrer","aria-label":n.label,class:"inline-flex h-12 w-12 items-center justify-center rounded-full border border-border bg-background text-lg hover:bg-accent"},[o("i",{class:S(n.iconClass)},null,2)],8,je))),128))])])):d("",!0)])])]),o("section",Be,[o("div",Le,[(s(!0),a(V,null,M(w.value,n=>(s(),a("button",{key:n.id,type:"button",class:"group overflow-hidden border border-border bg-card text-left",onClick:f=>I(n.full)},[o("img",{src:n.thumb,alt:"Post image",class:"aspect-[3/4] w-full object-cover transition-transform duration-200 group-hover:scale-[1.03]",loading:"lazy"},null,8,Te)],8,Ie))),128))]),w.value.length===0?(s(),a("div",Ae," No photos published yet. ")):d("",!0)]),C(ee,{url:b.value,title:r.profile.name},null,8,["url","title"]),C(F,{modelValue:m.value,"onUpdate:modelValue":i[1]||(i[1]=n=>m.value=n),photos:h.value,"initial-index":x.value},null,8,["modelValue","photos","initial-index"]),u.value?(s(),j(F,{key:0,modelValue:y.value,"onUpdate:modelValue":i[2]||(i[2]=n=>y.value=n),photos:[u.value],title:"Profile Photo"},null,8,["modelValue","photos"])):d("",!0)]),_:1})],64))}});export{Ke as default};
