import{d as P,q as X,u as a,K as J,w as n,I as Z,o as h,ak as ee,c as U,a as l,b as u,e as d,ah as ae,y as te,p as le,t as C,f as E,g as z,x as q,E as N,s as re,j as R,h as se,k as H}from"./app-BXlxvPJ4.js";import{_ as oe}from"./AvatarUpload.vue_vue_type_script_setup_true_lang-C8iX2Yq7.js";import{q as T}from"./index-ueziRkVZ.js";import{a as S,_ as ne}from"./Layout.vue_vue_type_script_setup_true_lang-D8QUBQY3.js";import{_ as x}from"./InputError.vue_vue_type_script_setup_true_lang-DDcA0SiJ.js";import{_ as D}from"./FlashMessages.vue_vue_type_script_setup_true_lang-HONSxRlG.js";import{w as ue,a as de,b as ie,c as me,d as pe,B as fe,_ as ce,A as ge}from"./UserMenuContent.vue_vue_type_script_setup_true_lang-D9b9PEsY.js";import{_ as _e}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-D4N2MuIz.js";import{_ as c}from"./Input.vue_vue_type_script_setup_true_lang-Bhhprupd.js";import{_ as f}from"./Label.vue_vue_type_script_setup_true_lang-DYoyNtCe.js";import{_ as O}from"./LoadingButton.vue_vue_type_script_setup_true_lang-HJHBRm1v.js";import{_ as ye}from"./AppLayout.vue_vue_type_script_setup_true_lang-DG7I23hc.js";import"./createLucideIcon-BhpRTv15.js";import"./index-BB3w2Cxu.js";import"./index-DZmBbJgz.js";import"./useForwardPropsEmits-CYY9JK-I.js";import"./RovingFocusGroup-DWhwfIpB.js";import"./useForwardExpose-COt-7_XK.js";import"./index-C78dSs6T.js";import"./Spinner.vue_vue_type_script_setup_true_lang-DuwWGKtl.js";import"./VisuallyHidden-C9aoMcVK.js";const ve=P({__name:"DialogClose",props:{asChild:{type:Boolean},as:{}},setup(e){const y=e;return(p,s)=>(h(),X(a(ue),J({"data-slot":"dialog-close"},y),{default:n(()=>[Z(p.$slots,"default")]),_:3},16))}}),g=e=>({url:g.url(e),method:"get"});g.definition={methods:["get","head"],url:"/settings/profile"};g.url=e=>g.definition.url+T(e);g.get=e=>({url:g.url(e),method:"get"});g.head=e=>({url:g.url(e),method:"head"});const B=e=>({action:g.url(e),method:"get"});B.get=e=>({action:g.url(e),method:"get"});B.head=e=>({action:g.url({[e?.mergeQuery?"mergeQuery":"query"]:{_method:"HEAD",...e?.query??e?.mergeQuery??{}}}),method:"get"});g.form=B;const _=e=>({url:_.url(e),method:"patch"});_.definition={methods:["patch","put"],url:"/settings/profile"};_.url=e=>_.definition.url+T(e);_.patch=e=>({url:_.url(e),method:"patch"});_.put=e=>({url:_.url(e),method:"put"});const F=e=>({action:_.url({[e?.mergeQuery?"mergeQuery":"query"]:{_method:"PATCH",...e?.query??e?.mergeQuery??{}}}),method:"post"});F.patch=e=>({action:_.url({[e?.mergeQuery?"mergeQuery":"query"]:{_method:"PATCH",...e?.query??e?.mergeQuery??{}}}),method:"post"});F.put=e=>({action:_.url({[e?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...e?.query??e?.mergeQuery??{}}}),method:"post"});_.form=F;const k=e=>({url:k.url(e),method:"put"});k.definition={methods:["put"],url:"/settings/avatar"};k.url=e=>k.definition.url+T(e);k.put=e=>({url:k.url(e),method:"put"});const K=e=>({action:k.url({[e?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...e?.query??e?.mergeQuery??{}}}),method:"post"});K.put=e=>({action:k.url({[e?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...e?.query??e?.mergeQuery??{}}}),method:"post"});k.form=K;const w=e=>({url:w.url(e),method:"delete"});w.definition={methods:["delete"],url:"/settings/profile"};w.url=e=>w.definition.url+T(e);w.delete=e=>({url:w.url(e),method:"delete"});const M=e=>({action:w.url({[e?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...e?.query??e?.mergeQuery??{}}}),method:"post"});M.delete=e=>({action:w.url({[e?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...e?.query??e?.mergeQuery??{}}}),method:"post"});w.form=M;const be={edit:g,update:_,updateAvatar:k,destroy:w},he={class:"space-y-6"},Ve={class:"space-y-4 rounded-lg border border-red-100 bg-red-50 p-4 dark:border-red-200/10 dark:bg-red-700/10"},xe={class:"grid gap-2"},ke=P({__name:"DeleteUser",setup(e){const y=ee("passwordInput");return(p,s)=>(h(),U("div",he,[l(S,{variant:"small",title:"Delete account",description:"Delete your account and all of its resources"}),u("div",Ve,[s[7]||(s[7]=u("div",{class:"relative space-y-0.5 text-red-600 dark:text-red-100"},[u("p",{class:"font-medium"},"Warning"),u("p",{class:"text-sm"}," Please proceed with caution, this cannot be undone. ")],-1)),l(a(ce),null,{default:n(()=>[l(a(_e),{"as-child":""},{default:n(()=>[l(a(D),{variant:"destructive","data-test":"delete-user-button"},{default:n(()=>[...s[1]||(s[1]=[d("Delete account",-1)])]),_:1})]),_:1}),l(a(de),null,{default:n(()=>[l(a(ae),J(a(be).destroy.form(),{"reset-on-success":"",onError:s[0]||(s[0]=()=>y.value?.$el?.focus()),options:{preserveScroll:!0},class:"space-y-6"}),{default:n(({errors:r,processing:i,reset:v,clearErrors:$})=>[l(a(ie),{class:"space-y-3"},{default:n(()=>[l(a(me),null,{default:n(()=>[...s[2]||(s[2]=[d("Are you sure you want to delete your account?",-1)])]),_:1}),l(a(pe),null,{default:n(()=>[...s[3]||(s[3]=[d(" Once your account is deleted, all of its resources and data will also be permanently deleted. Please enter your password to confirm you would like to permanently delete your account. ",-1)])]),_:1})]),_:1}),u("div",xe,[l(a(f),{for:"password",class:"sr-only"},{default:n(()=>[...s[4]||(s[4]=[d("Password",-1)])]),_:1}),l(a(c),{id:"password",type:"password",name:"password",ref_key:"passwordInput",ref:y,placeholder:"Password"},null,512),l(x,{message:r.password},null,8,["message"])]),l(a(fe),{class:"gap-2"},{default:n(()=>[l(a(ve),{"as-child":""},{default:n(()=>[l(a(D),{variant:"secondary",onClick:()=>{$(),v()}},{default:n(()=>[...s[5]||(s[5]=[d(" Cancel ",-1)])]),_:1},8,["onClick"])]),_:2},1024),l(a(D),{type:"submit",variant:"destructive",disabled:i,"data-test":"confirm-delete-user-button"},{default:n(()=>[...s[6]||(s[6]=[d(" Delete account ",-1)])]),_:1},8,["disabled"])]),_:2},1024)]),_:1},16)]),_:1})]),_:1})])]))}}),we={class:"grid gap-2"},Ue={class:"relative"},$e={key:0,class:"text-xs text-muted-foreground"},qe={key:0,class:"text-destructive"},Pe={key:1},Qe={key:2,class:"text-green-600"},Ae={key:3,class:"text-destructive"},Ce=P({__name:"UsernameInput",props:{modelValue:{},name:{default:"username"},disabled:{type:Boolean,default:!1},checkAvailability:{type:Boolean,default:!0}},emits:["update:modelValue","availability"],setup(e,{emit:y}){const p=e,s=y,r=N(),i=z(!1),v=z(null),$=/^[a-z0-9_]+$/;let V=0,t=null;const o=q(()=>r.props.errors?.[p.name]??null),I=m=>m.replace(/^@+/,"").toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"").replace(/_+/g,"_").replace(/^_+|_+$/g,"").slice(0,30),W=m=>m===""?null:m.length<3?"Username must be at least 3 characters.":$.test(m)?null:"Username may only contain lowercase letters, numbers, and underscores.",L=q(()=>W(p.modelValue)),Q=()=>{v.value=null,s("availability",null)},G=async m=>{if(!p.checkAvailability)return;if(W(m)!==null){i.value=!1,Q();return}const b=++V;i.value=!0;try{const A=await fetch("/api/check-username",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")??""},body:JSON.stringify({username:m})});if(b!==V)return;if(!A.ok){Q();return}const j=await A.json();v.value=typeof j.data?.available=="boolean"?j.data.available:null,s("availability",v.value)}catch{if(b!==V)return;Q()}finally{b===V&&(i.value=!1)}};te(()=>p.modelValue,m=>{t!==null&&clearTimeout(t);const b=I(m);if(b!==m){s("update:modelValue",b);return}V++,i.value=!1,Q(),t=setTimeout(()=>{G(m)},400)}),le(()=>{t!==null&&clearTimeout(t)});const Y=m=>{s("update:modelValue",I(m))};return(m,b)=>(h(),U("div",we,[u("div",Ue,[b[1]||(b[1]=u("span",{class:"absolute top-1/2 left-3 -translate-y-1/2 text-muted-foreground"},"@",-1)),l(a(c),{name:e.name,disabled:e.disabled,"model-value":e.modelValue,class:"pl-7",placeholder:"username","onUpdate:modelValue":b[0]||(b[0]=A=>Y(A))},null,8,["name","disabled","model-value"])]),e.checkAvailability?(h(),U("div",$e,[L.value?(h(),U("span",qe,C(L.value),1)):i.value?(h(),U("span",Pe,"Checking availability...")):v.value===!0?(h(),U("span",Qe,"Username is available.")):v.value===!1?(h(),U("span",Ae,"Username is not available.")):E("",!0)])):E("",!0),l(x,{message:o.value},null,8,["message"])]))}}),Te={class:"grid gap-2"},De=["name","rows","value","placeholder"],Ee=P({__name:"WordCountTextarea",props:{modelValue:{},name:{default:"bio"},maxWords:{default:100},rows:{default:4},placeholder:{default:""}},emits:["update:modelValue"],setup(e,{emit:y}){const p=e,s=y,r=N(),i=q(()=>{const V=p.modelValue.trim();return V===""?0:V.split(/\s+/).length}),v=q(()=>i.value>p.maxWords?"text-destructive":i.value>=p.maxWords-10?"text-amber-600":"text-muted-foreground"),$=q(()=>r.props.errors?.[p.name]??null);return(V,t)=>(h(),U("div",Te,[u("textarea",{name:e.name,rows:e.rows,value:e.modelValue,placeholder:e.placeholder,class:"flex min-h-24 w-full rounded-md border border-input bg-background px-3 py-2 text-sm shadow-xs outline-none ring-ring/50 transition-[color,box-shadow] placeholder:text-muted-foreground focus-visible:ring-[3px]",onInput:t[0]||(t[0]=o=>s("update:modelValue",o.target.value))},null,40,De),u("div",{class:re(["text-right text-xs",v.value])},C(i.value)+" / "+C(e.maxWords)+" words ",3),l(x,{message:$.value},null,8,["message"])]))}}),Se={class:"space-y-6"},Ne={class:"grid gap-2"},Be={class:"grid gap-2"},Fe={class:"grid gap-2"},Ie={key:0,class:"text-xs text-muted-foreground"},We={class:"grid gap-4 md:grid-cols-2"},Le={class:"grid gap-2"},je={class:"grid gap-2"},ze={class:"grid gap-2"},Re={class:"grid gap-2"},He={class:"grid gap-4 md:grid-cols-2"},Oe={class:"grid gap-2"},Xe={class:"grid gap-2"},Je={class:"grid gap-2"},Ke={class:"grid gap-2"},Me={class:"grid gap-2"},Ge={class:"space-y-4"},ba=P({__name:"Profile",props:{canUpdateUsernameAt:{}},setup(e){const y=e,s=N().props.auth.user,r=R({name:s?.name??"",email:s?.email??"",username:s?.username??"",bio:s?.bio??"",profession:s?.profession??"",location:s?.location??"",phone:s?.phone??"",facebook_username:s?.facebook_username??"",x_username:s?.x_username??"",tiktok_username:s?.tiktok_username??"",instagram_username:s?.instagram_username??"",website:s?.website??"",email_public:s?.email_public??""}),i=R({avatar:null}),v=()=>{r.put("/settings/profile")},$=()=>{i.put("/settings/avatar",{forceFormData:!0})};return(V,t)=>(h(),X(ye,{breadcrumbs:[{title:"Profile settings",href:a(ge)().url}]},{default:n(()=>[l(a(se),{title:"Profile settings"}),l(ne,null,{default:n(()=>[u("div",Se,[l(S,{variant:"small",title:"Profile information",description:"Update your public and account profile details."}),u("form",{class:"space-y-6",onSubmit:H(v,["prevent"])},[u("div",Ne,[l(a(f),{for:"name"},{default:n(()=>[...t[14]||(t[14]=[d("Name",-1)])]),_:1}),l(a(c),{id:"name",modelValue:a(r).name,"onUpdate:modelValue":t[0]||(t[0]=o=>a(r).name=o),placeholder:"e.g. Jane Doe"},null,8,["modelValue"]),l(x,{message:a(r).errors.name},null,8,["message"])]),u("div",Be,[l(a(f),{for:"email"},{default:n(()=>[...t[15]||(t[15]=[d("Email",-1)])]),_:1}),l(a(c),{id:"email",type:"email",modelValue:a(r).email,"onUpdate:modelValue":t[1]||(t[1]=o=>a(r).email=o),placeholder:"you@example.com"},null,8,["modelValue"]),l(x,{message:a(r).errors.email},null,8,["message"])]),u("div",Fe,[l(a(f),null,{default:n(()=>[...t[16]||(t[16]=[d("Username",-1)])]),_:1}),l(Ce,{modelValue:a(r).username,"onUpdate:modelValue":t[2]||(t[2]=o=>a(r).username=o)},null,8,["modelValue"]),y.canUpdateUsernameAt?(h(),U("p",Ie," Next change available on "+C(new Date(y.canUpdateUsernameAt).toLocaleDateString()),1)):E("",!0)]),l(Ee,{modelValue:a(r).bio,"onUpdate:modelValue":t[3]||(t[3]=o=>a(r).bio=o),name:"bio",placeholder:"Tell your class about yourself"},null,8,["modelValue"]),u("div",We,[u("div",Le,[l(a(f),{for:"profession"},{default:n(()=>[...t[17]||(t[17]=[d("Profession",-1)])]),_:1}),l(a(c),{id:"profession",modelValue:a(r).profession,"onUpdate:modelValue":t[4]||(t[4]=o=>a(r).profession=o),placeholder:"e.g. Photographer"},null,8,["modelValue"]),l(x,{message:a(r).errors.profession},null,8,["message"])]),u("div",je,[l(a(f),{for:"location"},{default:n(()=>[...t[18]||(t[18]=[d("Location",-1)])]),_:1}),l(a(c),{id:"location",modelValue:a(r).location,"onUpdate:modelValue":t[5]||(t[5]=o=>a(r).location=o),placeholder:"e.g. Lagos, Nigeria"},null,8,["modelValue"]),l(x,{message:a(r).errors.location},null,8,["message"])])]),u("div",ze,[l(a(f),{for:"phone"},{default:n(()=>[...t[19]||(t[19]=[d("WhatsApp Number",-1)])]),_:1}),l(a(c),{id:"phone",modelValue:a(r).phone,"onUpdate:modelValue":t[6]||(t[6]=o=>a(r).phone=o),placeholder:"+1 555 123 4567"},null,8,["modelValue"]),l(x,{message:a(r).errors.phone},null,8,["message"])]),u("div",Re,[l(a(f),{for:"website"},{default:n(()=>[...t[20]||(t[20]=[d("Website (without https://)",-1)])]),_:1}),l(a(c),{id:"website",modelValue:a(r).website,"onUpdate:modelValue":t[7]||(t[7]=o=>a(r).website=o),placeholder:"example.com"},null,8,["modelValue"]),l(x,{message:a(r).errors.website},null,8,["message"])]),u("div",He,[u("div",Oe,[l(a(f),{for:"facebook_username"},{default:n(()=>[...t[21]||(t[21]=[d("Facebook",-1)])]),_:1}),l(a(c),{id:"facebook_username",modelValue:a(r).facebook_username,"onUpdate:modelValue":t[8]||(t[8]=o=>a(r).facebook_username=o),placeholder:"facebook_username"},null,8,["modelValue"])]),u("div",Xe,[l(a(f),{for:"x_username"},{default:n(()=>[...t[22]||(t[22]=[d("X",-1)])]),_:1}),l(a(c),{id:"x_username",modelValue:a(r).x_username,"onUpdate:modelValue":t[9]||(t[9]=o=>a(r).x_username=o),placeholder:"x_username"},null,8,["modelValue"])]),u("div",Je,[l(a(f),{for:"tiktok_username"},{default:n(()=>[...t[23]||(t[23]=[d("TikTok",-1)])]),_:1}),l(a(c),{id:"tiktok_username",modelValue:a(r).tiktok_username,"onUpdate:modelValue":t[10]||(t[10]=o=>a(r).tiktok_username=o),placeholder:"tiktok_username"},null,8,["modelValue"])]),u("div",Ke,[l(a(f),{for:"instagram_username"},{default:n(()=>[...t[24]||(t[24]=[d("Instagram",-1)])]),_:1}),l(a(c),{id:"instagram_username",modelValue:a(r).instagram_username,"onUpdate:modelValue":t[11]||(t[11]=o=>a(r).instagram_username=o),placeholder:"instagram_username"},null,8,["modelValue"])])]),u("div",Me,[l(a(f),{for:"email_public"},{default:n(()=>[...t[25]||(t[25]=[d("Public Email",-1)])]),_:1}),l(a(c),{id:"email_public",type:"email",modelValue:a(r).email_public,"onUpdate:modelValue":t[12]||(t[12]=o=>a(r).email_public=o),placeholder:"public-contact@example.com"},null,8,["modelValue"]),l(x,{message:a(r).errors.email_public},null,8,["message"])]),l(O,{type:"submit",loading:a(r).processing,"loading-text":"Saving..."},{default:n(()=>[...t[26]||(t[26]=[d(" Save Profile ",-1)])]),_:1},8,["loading"])],32)]),u("div",Ge,[l(S,{variant:"small",title:"Avatar",description:"Upload and replace your profile picture."}),u("form",{class:"space-y-4",onSubmit:H($,["prevent"])},[l(oe,{modelValue:a(i).avatar,"onUpdate:modelValue":t[13]||(t[13]=o=>a(i).avatar=o),"current-avatar":a(s)?.avatar??null},null,8,["modelValue","current-avatar"]),l(O,{type:"submit",loading:a(i).processing,"loading-text":"Uploading..."},{default:n(()=>[...t[27]||(t[27]=[d(" Update Avatar ",-1)])]),_:1},8,["loading"])],32)]),l(ke)]),_:1})]),_:1},8,["breadcrumbs"]))}});export{ba as default};
